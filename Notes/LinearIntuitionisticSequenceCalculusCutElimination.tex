\documentclass[12pt]{article}

\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{array}
\usepackage{mathrsfs}
\usepackage{amssymb}
\usepackage{units}
\usepackage{graphicx}
\usepackage{tikz-cd}
\usepackage{nicefrac}
\usepackage{hyperref}
\usepackage{bbm}
\usepackage{color}
\usepackage{tensor}
\usepackage{tipa}
\usepackage{bussproofs}
\usepackage{ stmaryrd }
\usepackage{ textcomp }
\usepackage{leftidx}
\usepackage{afterpage}
\usepackage{varwidth}
\usepackage{bm}
\usepackage{ cmll }
\usepackage[final]{showlabels}

\newcommand\blankpage{
    \null
    \thispagestyle{empty}
    \addtocounter{page}{-1}
    \newpage
    }

\graphicspath{ {images/} }

\theoremstyle{plain}
\newtheorem{thm}{Theorem}[subsection] % reset theorem numbering for each chapter
\newtheorem{proposition}[thm]{Proposition}
\newtheorem{lemma}[thm]{Lemma}
\newtheorem{fact}[thm]{Fact}
\newtheorem{cor}[thm]{Corollary}

\theoremstyle{definition}
\newtheorem{defn}[thm]{Definition} % definition numbers are dependent on theorem numbers
\newtheorem{exmp}[thm]{Example} % same for example numbers
\newtheorem{notation}[thm]{Notation}
\newtheorem{remark}[thm]{Remark}
\newtheorem{condition}[thm]{Condition}
\newtheorem{question}[thm]{Question}
\newtheorem{construction}[thm]{Construction}
\newtheorem{exercise}[thm]{Exercise}
\newtheorem{example}[thm]{Example}
\newtheorem{algorithm}[thm]{Algorithm}

\newcommand{\bb}[1]{\mathbb{#1}}
\newcommand{\scr}[1]{\mathscr{#1}}
\newcommand{\call}[1]{\mathcal{#1}}
\newcommand{\psheaf}{\text{\underline{Set}}^{\scr{C}^{\text{op}}}}
\newcommand{\und}[1]{\underline{\hspace{#1 cm}}}
\newcommand{\adj}[1]{\text{\textopencorner}{#1}\text{\textcorner}}
\newcommand{\comment}[1]{}
\newcommand{\lto}{\longrightarrow}
\newcommand{\rone}{(\operatorname{R}\bold{1})}
\newcommand{\lone}{(\operatorname{L}\bold{1})}
\newcommand{\rimp}{(\operatorname{R} \multimap)}
\newcommand{\limp}{(\operatorname{L} \multimap)}
\newcommand{\rtensor}{(\operatorname{R}\otimes)}
\newcommand{\ltensor}{(\operatorname{L}\otimes)}
\newcommand{\rtrue}{(\operatorname{R}\top)}
\newcommand{\rwith}{(\operatorname{R}\&)}
\newcommand{\lwithleft}{(\operatorname{L}\&)_{\operatorname{left}}}
\newcommand{\lwithright}{(\operatorname{L}\&)_{\operatorname{right}}}
\newcommand{\rplusleft}{(\operatorname{R}\oplus)_{\operatorname{left}}}
\newcommand{\rplusright}{(\operatorname{R}\oplus)_{\operatorname{right}}}
\newcommand{\lplus}{(\operatorname{L}\oplus)}
\newcommand{\prom}{(\operatorname{prom})}
\newcommand{\ctr}{(\operatorname{ctr})}
\newcommand{\der}{(\operatorname{der})}
\newcommand{\weak}{(\operatorname{weak})}
\newcommand{\exi}{(\operatorname{exists})}
\newcommand{\fa}{(\operatorname{for\text{ }all})}
\newcommand{\ex}{(\operatorname{ex})}
\newcommand{\cut}{(\operatorname{cut})}
\newcommand{\ax}{(\operatorname{ax})}
\newcommand{\true}{\top}
\newcommand{\tagarray}{\mbox{}\refstepcounter{equation}$(\theequation)$}
\newcommand{\startproof}[1]{
\AxiomC{#1}
\noLine
\UnaryInfC{$\vdots$}
}
\newenvironment{scprooftree}[1]%
  {\gdef\scalefactor{#1}\begin{center}\proofSkipAmount \leavevmode}%
  {\scalebox{\scalefactor}{\DisplayProof}\proofSkipAmount \end{center} }

\usepackage[margin=1cm]{geometry}

\title{The Intuitionistic, Linear Sequent Calculus and cut elimination}
\author{Will Troiani}
\date{January 2021}

\begin{document}

\maketitle
\tableofcontents

\section{Introduction}
The paper titled Gentzen-Mints-Zucker Duality \cite{GMZ} provides an constructive proof  of the Cut Elimination Theorem for intuitionistic sequent calculus.

The proof presented there extends easily to the intuitionistic linear logic sequent calculus. This note writes out this extension, and also \emph{defines} the intuitionistic linear logic sequent calculus, as this was only presented implicitly in \cite{blind}.

\section{Intuitionistic Sequent Calculus}\label{Sec:intuitionistic_linear_sequent_calculus}
The \emph{Intuitionistic, Linear Sequent Calculus} is defined loosely in \cite[\S 11.1.2]{blind}, for clarity, we define here this system precisely.

\begin{defn}
There is a countably infinite set of \textbf{atomic formulas} $\scr{F} = \lbrace p,q,r\hdots \rbrace$ including special formulas (or \textbf{constants}) $\bold{1}, \top$, and a set of \textbf{formulas} $\Psi_{\bold{1},\top,\otimes, \oplus, \&, !}$ (or simply $\Psi$) which is the smallest set subject to the following constraints:
\begin{itemize}
    \item all atomic formulas are formulas, that is, if $p \in \scr{F}$ then $p \in \Psi$,
    \item if $A$ and $B$ are formulas then so are $A \otimes B$, $A \oplus B$, $A \& B$,
    \item if $A$ is a formula then so is $!A$ (pronounced ``of course $A$", or ``bang $A$").
\end{itemize}
\end{defn}

\begin{defn}\label{def:sequent_calc}
A \textbf{deduction rule} results from one of the schemata below by a substitution of the following kind: replace $A,B,C$ by arbitrary formulas, $x,y$ by arbitrary formulas, and $\Gamma,\Delta, \Theta$ by arbitrary (possibly empty) sequences of formulas separated by commas:

\begin{itemize}
    \item The \textbf{identity group}:
\begin{center}
    \begin{tabular}{ >{\centering}m{2cm} >{\centering}m{7cm} >{\centering}m{0.5cm} }
        \textbf{Axiom}
        &
        \begin{prooftree}
        \AxiomC{}
        \RightLabel{$({\operatorname{ax}})$}
        \UnaryInfC{$A \vdash A$}
        \end{prooftree}
        &
        \tagarray{\label{LL:ax}}
    \end{tabular}
\end{center}

\begin{center}
    \begin{tabular}{ >{\centering}m{2cm} >{\centering}m{7cm} >{\centering}m{0.5cm} }
        \textbf{Cut}
        &
        \begin{prooftree}
        \AxiomC{$\Gamma \vdash A$}
        \AxiomC{$\Delta, A,\Theta \vdash B$}
        \RightLabel{$({\operatorname{cut}})$}
        \BinaryInfC{$\Gamma, \Delta, \Theta \vdash B$}
        \end{prooftree}
        &
        \tagarray{\label{LL:cut}}
    \end{tabular}
\end{center}
\item The \textbf{logical rules}:\\\\
The \textbf{multiplicative group}:
\begin{center}
    \begin{tabular}{ >{\centering}m{3cm} >{\centering}m{5cm} >{\centering}m{5cm} >{\centering}m{0.5cm} }
        \textbf{Left/right one}
        &
        \AxiomC{$\Gamma, \Gamma' \vdash A$}
            \RightLabel{$\lone$}
            \UnaryInfC{$\Gamma, \bold{1}, \Gamma' \vdash A$}
            \DisplayProof
        &
        \begin{prooftree}
            \AxiomC{}
        \RightLabel{$\rone$}
        \UnaryInfC{$\vdash \bold{1}$}
        \end{prooftree}
        &
        \tagarray{\label{LL:one}}
    \end{tabular}
\end{center}

\begin{center}
    \begin{tabular}{ >{\centering}m{3cm} >{\centering}m{5cm} >{\centering}m{5cm} >{\centering}m{0.5cm} }
        \textbf{Left/right times}
        &
        \AxiomC{$\Gamma, A, B, \Gamma' \vdash C$}
            \RightLabel{$\ltensor$}
            \UnaryInfC{$\Gamma, A \otimes B, \Gamma' \vdash C$}
            \DisplayProof
        &
        \AxiomC{$\Gamma \vdash A$}
        \AxiomC{$\Delta\vdash B$}
        \RightLabel{$\rtensor$}
        \BinaryInfC{$\Gamma, \Delta \vdash A \otimes B$}
        \DisplayProof
        &
        \tagarray{\label{LL:times}}
    \end{tabular}
\end{center}
    
The \textbf{additive group}:    
\begin{center}
    \begin{tabular}{ >{\centering}m{2cm} >{\centering}m{7cm} >{\centering}m{0.5cm} }
        \textbf{True}
        &
        \AxiomC{}
            \RightLabel{$\rtrue$}
            \UnaryInfC{$\Gamma \vdash \top$}
            \DisplayProof
        &
        \tagarray{\label{LL:true}}
    \end{tabular}
\end{center}
    
\begin{center}
    \begin{tabular}{ >{\centering}m{3cm} >{\centering}m{5cm} >{\centering}m{5cm} >{\centering}m{0.5cm} }
        \textbf{Right plus (left and right)}
        &
        \AxiomC{$\Gamma \vdash A$}
            \RightLabel{$\rplusleft$}
            \UnaryInfC{$\Gamma \vdash A \oplus B$}
            \DisplayProof
            \qquad
            
        &
        \AxiomC{$\Gamma \vdash A$}
            \RightLabel{$\rplusright$}
            \UnaryInfC{$\Gamma \vdash B\oplus A$}
            \DisplayProof
        &
        \tagarray{\label{LL:rightplus}}
    \end{tabular}
\end{center}

\begin{center}
    \begin{tabular}{ >{\centering}m{2cm} >{\centering}m{8cm} >{\centering}m{0.5cm} }
        \textbf{Left plus}
        &
        \AxiomC{$\Gamma, A, \Gamma' \vdash C$}
        \AxiomC{$\Gamma, B, \Gamma' \vdash C$}
        \RightLabel{$\lplus$}
        \BinaryInfC{$\Gamma, A \oplus B, \Gamma' \vdash C$}
        \DisplayProof
        &
        \tagarray{\label{LL:leftplus}}
    \end{tabular}
\end{center}

\begin{center}
    \begin{tabular}{ >{\centering}m{2cm} >{\centering}m{7cm} >{\centering}m{0.5cm} }
        \textbf{Right with}
        &
        \begin{prooftree}
            \AxiomC{$\Gamma \vdash A$}
            \AxiomC{$\Gamma \vdash B$}
            \RightLabel{$\rwith$}
            \BinaryInfC{$\Gamma \vdash A \& B$}
        \end{prooftree}
        &
        \tagarray{\label{LL:withright}}
    \end{tabular}
\end{center}

\begin{center}
    \begin{tabular}{ >{\centering}m{2.9cm} >{\centering}m{5cm} >{\centering}m{5cm} >{\centering}m{0.5cm} }
        \textbf{Left with (left and right)}
        &
        \AxiomC{$\Gamma, A, \Gamma' \vdash B$}
            \RightLabel{$\lwithleft$}
            \UnaryInfC{$\Gamma, A \& C, \Gamma' \vdash B$}
            \DisplayProof
            
        &
        \AxiomC{$\Gamma, A, \Gamma' \vdash B$}
            \RightLabel{$\lwithright$}
            \UnaryInfC{$\Gamma, C \& A, \Gamma' \vdash B$}
            \DisplayProof
        &
        \tagarray{\label{LL:rightplus}}
    \end{tabular}
\end{center}

The \textbf{implication group}
\begin{center}
    \begin{tabular}{ >{\centering}m{2.9cm} >{\centering}m{5cm} >{\centering}m{7cm} >{\centering}m{0.5cm} }
        \textbf{Left/right implication}
        &
            \AxiomC{$\Gamma, A, \Gamma' \vdash B$}
        \RightLabel{$\rimp$}
        \UnaryInfC{$\Gamma, \Gamma' \vdash A \multimap B$}
        \DisplayProof
            
        &
        \AxiomC{$\Gamma \vdash A$}
        \AxiomC{$\Delta, B, \Delta' \vdash C$}
        \RightLabel{$\limp$}
        \BinaryInfC{$A \multimap B, \Gamma, \Delta, \Delta' \vdash C$}
        \DisplayProof
        &
        \tagarray{\label{LL:implication}}
    \end{tabular}
\end{center}

\item The \textbf{exponential rule}:
\begin{center}
    \begin{tabular}{ >{\centering}m{2cm} >{\centering}m{7cm} >{\centering}m{0.5cm} }
        \textbf{Promotion}
        &
        \AxiomC{$!\Gamma \vdash A$}
            \RightLabel{$\prom$}
            \UnaryInfC{$!\Gamma \vdash !A$}
            \DisplayProof
        &
        \tagarray{\label{LL:promotion}}
    \end{tabular}
\end{center}

\item the \textbf{structural rules}
\begin{center}
    \begin{tabular}{ >{\centering}m{2cm} >{\centering}m{7cm} >{\centering}m{0.5cm} }
        \textbf{Dereliction}
        &
        \AxiomC{$\Gamma, A, \Gamma' \vdash B$}
            \RightLabel{$\der$}
            \UnaryInfC{$\Gamma, !A, \Gamma' \vdash B$}
            \DisplayProof
        &
        \tagarray{\label{LL:dereliction}}
    \end{tabular}
\end{center}

\begin{center}
    \begin{tabular}{ >{\centering}m{2cm} >{\centering}m{7cm} >{\centering}m{0.5cm} }
        \textbf{Exchange}
        &
        \begin{prooftree}
        \AxiomC{$\Gamma, A, B, \Gamma' \vdash C$}
        \RightLabel{$({\operatorname{ex}})$}
        \UnaryInfC{$\Gamma, B, A, \Gamma' \vdash C$}
        \end{prooftree}
        &
        \tagarray{\label{LL:exchange}}
    \end{tabular}
\end{center}

\begin{center}
    \begin{tabular}{ >{\centering}m{2cm} >{\centering}m{7cm} >{\centering}m{0.5cm} }
        \textbf{Contraction}
        &
        \AxiomC{$\Gamma, !A, !A, \Gamma' \vdash B$}
            \RightLabel{$\ctr$}
            \UnaryInfC{$\Gamma, !A, \Gamma' \vdash B$}
            \DisplayProof
        &
        \tagarray{\label{LL:contraction}}
    \end{tabular}
\end{center}

\begin{center}
    \begin{tabular}{ >{\centering}m{2cm} >{\centering}m{7cm} >{\centering}m{0.5cm} }
        \textbf{Weakening}
        &
        \AxiomC{$\Gamma, \Gamma' \vdash A$}
            \RightLabel{$\weak$}
            \UnaryInfC{$\Gamma, !B, \Gamma' \vdash A$}
            \DisplayProof
        &
        \tagarray{\label{LL:weakening}}
    \end{tabular}
\end{center}
\end{itemize}

\end{defn}
When a logical system has few enough rules, each can be considered individually when listing equivalence relation generators, as was done in \cite{GMZ}, where seven deduction rules were considered. Definition \ref{def:sequent_calc} lists \emph{twenty} rules, so, to make what follows more comprehensible, we organise the deduction rules into sets rather than dealing with each pair of rules indivisually.
\begin{defn}\label{def:deduction_rules_partition}
We define the following sets of deduction rules:
\begin{itemize}
    \item Any deduction rule which is none of $\ax, \rtrue, \rone, \cut, \lplus,\rwith$ is a \textbf{proper deduction rule}.
    \item The \textbf{left rules} are:
    \begin{equation}
        \lplus, \lone, \ltensor, \lwithleft, \lwithright, \limp, \der, \ex, \ctr, \weak,
    \end{equation}
    and the \textbf{right rules} are:
    \begin{equation}
        \rone, \rtensor, \rplusleft, \rplusright, \rimp, \rwith, \prom
    \end{equation}
    \item The \textbf{zero-ary} rules are
    \begin{equation}
        \ax, \rtrue, \rone
    \end{equation}
    the \textbf{unary} rules are
    \begin{equation}
        \lone, \ltensor, \lwithleft,\lwithright, \der, \ex, \ctr, \weak, \rimp, \rplusleft, \rplusright
    \end{equation}
    and the \textbf{binary} rules are
    \begin{equation}
        \cut, \lplus, \limp, \rtensor, \rwith
    \end{equation}
\end{itemize}
We will often talk about intersections of these sets using adjectives, for example, the \textbf{proper, unary, left, logical rules} are:
    \begin{equation}
        \lone, \ltensor, \lwithleft, \lwithright
    \end{equation}
\end{defn}
\begin{remark}
These rules were derived from \cite{blind} and do not appear explicitly there. For instance, \eqref{LL:leftplus} comes from the following proof:
\begin{prooftree}
\AxiomC{$\Gamma, A, \Gamma' \vdash C$}
\RightLabel{$(\sim)$}
\UnaryInfC{$\vdash \sim \Gamma, \sim A, \sim \Gamma', C$}
\AxiomC{$\Gamma, B, \Gamma' \vdash C$}
\RightLabel{$(\sim)$}
\UnaryInfC{$\vdash \sim \Gamma, \sim B, \sim \Gamma', C$}
\RightLabel{$\rwith$}
\BinaryInfC{$\vdash \sim \Gamma, \sim A \& \sim B, \sim \Gamma', C$}
\RightLabel{$(\sim)$}
\UnaryInfC{$\Gamma, \sim(\sim A \& \sim B), \Gamma' \vdash C$}
\UnaryInfC{$\Gamma, A \oplus B, \Gamma' \vdash C$}
\end{prooftree}
As another example, there is no rule for $\bold{0}$ in \cite{blind}, and so there is no left $\top$ rule in Definition \ref{def:sequent_calc}.
\end{remark}
\begin{remark}
There is also the \textbf{quantification rules}:
\textbf{There exists and for all}
        \begin{center}
            \AxiomC{$\Gamma \vdash A[B/p]$}
            \RightLabel{$\exi$}
            \UnaryInfC{$\Gamma \vdash \exists p. A$}
            \DisplayProof
            \qquad
            \AxiomC{$\Gamma \vdash A$}
            \RightLabel{$\fa$}
            \UnaryInfC{$\Gamma \vdash \forall p. A$}
            \DisplayProof
        \end{center}
which we omit.
\end{remark}

\begin{remark}
In \cite{blind}, $\der$ is considered an \emph{exponential rule} rather than a \emph{structural rule}. In the proof of cut elimination \ref{Thm:cut_reduction} it will make more sense to consider $\der$ a structural rule, (as they all obey the same cut elimination step \eqref{cut:struc_or_unary_left_log_vs_any}).
\end{remark}
\begin{remark}
In \cite{blind} the following is taken as the exchange rule:
\begin{prooftree}
\AxiomC{$\Gamma \vdash A$}
\RightLabel{$\ex '$}
\UnaryInfC{$\Gamma' \vdash A$}
\end{prooftree}
where $\Gamma'$ is any sequence given by a perumtation of the elements of $\Gamma$. This rule can clearly be seen as a \emph{derived rule}, and so there is no significant difference between the two options for the Exchange rule.
\end{remark}
\begin{defn}
Following \cite{GMZ}, a \textbf{preproof} (or simply \textbf{proof}) is a finite rooted planar tree where each edge is labelled by a sequent and each node except for the root is labelled by a valid deduction rule. If the edge connected to the root is labelled by the sequent $\Gamma \vdash A$ then we call the proof a \textbf{proof of $\Gamma \vdash A$}. We denote the set of all preproofs by $\operatorname{Pre}\scr{P}$.
\end{defn}
\begin{remark}
Later, we define proofs (Definition \ref{def:proof_equivalence}) to be equivalence classes of preproofs, which overloads the term \emph{proofs}. Whether a proof or preproof is intended will be either made explicit, or clear from context.
\end{remark}
In \cite{GMZ} an equivalence relation was defined on the set of \emph{preproofs} whose edges were labelled by valid applications of the deduction rules of the system of \emph{intuitionistic sequent calculus} ($\operatorname{LJ}$ of \cite[\S III]{gentzen}). This equivalence relation was crucial to associating to each proof of a sequent $\Gamma \vdash p$ (in the notation of \cite{GMZ}) a unique $\lambda$-term whose free formulas are a subset of the underlying set of $\Gamma$. The Curry-Howard Isomorphism identifies $\lambda$-terms and proofs in the system of \emph{Natural deduction} ($\operatorname{NJ}$ of \cite{gentzen}). Invoking the same philosophy to the current context, our aim is to define an equivalence relation $\sim_p$ on the set of proofs so that to each equivalence class there is a unique, associated \emph{proof-net} (\cite{linear_logic}). For a discussion on why \emph{proofnets} correspond to \emph{natural deduction} for linear logic, see \cite[\S 11.2]{blind}.
\subsection{$\tau$-equivalence}
Could the laws of logic be determined by the laws of mathematics, rather than the other way around? This exciting question is explored by providing a \emph{semantics} for a logical system inside some category, for instance $k$-vector spaces where $k$ is a field \cite{cofree_cocommutative_coalgebra}. A prerequisite for studying this question is a minimum set of criterion for when two proofs should be given the same interpretation, we ask: when are two proofs considered \emph{the same}? We now define a family of equivalence relations on proofs, which answer this question:
\begin{remark}
In \cite{GMZ}, we defined \emph{compatible relations} which has an obvious analogue to the current context. We use this terminology throughout.
\end{remark}
\begin{defn}\label{def:tau-equivalence}
We define $\sim_{\tau}$ to be the smallest compatible equivalence relation on preproofs satisfying
    \begin{center}
    \begin{tabular}{ >{\centering}m{6cm} >{\centering}m{0.5cm} >{\centering}m{6cm} >{\centering}m{0.5cm}}
        \AxiomC{$\Gamma \vdash p$}
        \AxiomC{$\Delta, A,B,\Delta' \vdash C$}
        \RightLabel{$(\operatorname{ex})$}
        \UnaryInfC{$\Delta, B, A, \Theta \vdash C$}
        \RightLabel{$({\operatorname{cut}})$}
        \BinaryInfC{$\Gamma, \Delta, B, \Delta' \vdash C$}
        \DisplayProof
        &
        $\sim_\tau$
        &
        \AxiomC{$\Gamma \vdash A$}
        \AxiomC{$\Delta, A,B,\Theta \vdash C$}
        \RightLabel{$({\operatorname{cut}})$}
        \BinaryInfC{$\Gamma, \Delta, B, \Delta' \vdash C$}
        \DisplayProof
        &
        \tagarray{\label{tau_cut}}
    \end{tabular}
    \end{center}
    
    \begin{center}
    \begin{tabular}{ >{\centering}m{6cm} >{\centering}m{0.5cm} >{\centering}m{6cm} >{\centering}m{0.5cm}}
        \AxiomC{$\Gamma, A, A, B, \Gamma' \vdash C$}
        \RightLabel{$(\operatorname{ctr})$}
        \UnaryInfC{$\Gamma, A, B, \Gamma' \vdash C$}
        \RightLabel{$(\operatorname{ex})$}
        \UnaryInfC{$\Gamma, B, A, \Gamma' \vdash C$}
        \DisplayProof
        &
        $\sim_\tau$
        &
        \AxiomC{$\Gamma, A, A, B, \Gamma' \vdash C$}
        \doubleLine
        \RightLabel{$(\operatorname{ex})$}
        \UnaryInfC{$\Gamma, B, A, A, \Gamma' \vdash C$}
        \RightLabel{$\operatorname{(ctr)}$}
        \UnaryInfC{$\Gamma, B, A, \Gamma' \vdash C$}
        \DisplayProof
        &
        \tagarray{\label{tau_ctr_ex}}
    \end{tabular}
    \end{center}

\begin{center}
\begin{tabular}{ >{\centering}m{6cm} >{\centering}m{0.5cm} >{\centering}m{6cm} >{\centering}m{0.5cm}} 
         \AxiomC{$\Gamma, A, \Gamma' \vdash B$}
         \RightLabel{$(\operatorname{weak})$}
         \UnaryInfC{$\Gamma, A, !C, \Gamma' \vdash B$}
         \RightLabel{$(\operatorname{ex})$}
         \UnaryInfC{$\Gamma, !C, A, \Gamma' \vdash B$}
         \DisplayProof
         & $\sim_\tau$ &
         \AxiomC{$\Gamma, A, \Gamma' \vdash B$}
         \RightLabel{$(\operatorname{weak})$}
         \UnaryInfC{$\Gamma, !C, A, \Gamma' \vdash B$}
         \DisplayProof
         &
         \tagarray{\label{tau_weak_ex}}
\end{tabular}
\end{center}

    \begin{center}
    \begin{tabular}{>{\centering}m{6cm} >{\centering}m{0.5cm} >{\centering}m{6cm} >{\centering}m{0.5cm}}    
            \AxiomC{$\Gamma, A, B, \Gamma' \vdash C$}
            \RightLabel{$(\operatorname{ex})$}
            \UnaryInfC{$\Gamma, B, A, \Gamma' \vdash C$}
            \RightLabel{$\rimp$}
            \UnaryInfC{$\Gamma, A, \Gamma' \vdash B \multimap C$}
            \DisplayProof
            &
            $\sim_\tau$
            &
            \AxiomC{$\Gamma, A, B,\Gamma' \vdash C$}
            \RightLabel{$\rimp$}
            \UnaryInfC{$\Gamma, A, \Gamma' \vdash B \multimap C$}
            \DisplayProof
            &
            \tagarray{\label{tau_R_ex}}
    \end{tabular}
    \end{center}
    
    \begin{center}
    \begin{tabular}{>{\centering}m{10cm} >{\centering}m{0.5cm}}    
            \AxiomC{$\Gamma \vdash A$}
        \AxiomC{$\Delta, B, C, \Delta' \vdash D$}
        \RightLabel{$(\operatorname{ex})$}
        \UnaryInfC{$\Delta, C, B, \Delta' \vdash D$}
        \RightLabel{$\limp$}
        \BinaryInfC{$y: A\multimap B, \Gamma,\Delta, C, \Delta' \vdash D$}
            \DisplayProof\\\vspace{0.5cm}
            $\sim_\tau$\\\vspace{0.5cm}
            \AxiomC{$\Gamma \vdash A$}
        \AxiomC{$\Delta, B, C, \Delta' \vdash D$}
        \RightLabel{$\limp$}
        \BinaryInfC{$y: A\multimap B, \Gamma,\Delta, C, \Delta' \vdash D$}
            \DisplayProof
            &
            \tagarray{\label{tau_L_ex2}}
    \end{tabular}
    \end{center}
    
\begin{center}
\begin{tabular}{ >{\centering}m{10cm} >{\centering}m{0.5cm}} 
\AxiomC{$A_1, \ldots, A_n \vdash B$}
        \doubleLine
        \RightLabel{$(\operatorname{ex}, \sigma_1, \ldots, \sigma_r)$}
        \UnaryInfC{$A_{\tau 1}, \ldots, A_{\tau n} \vdash B$}
        \DisplayProof\\\vspace{0.5cm}
        $\sim_\tau$\\\vspace{0.5cm}
        \AxiomC{$A_1, \ldots, A_n \vdash B$}
        \doubleLine
        \RightLabel{$(\operatorname{ex}, \rho_1, \ldots, \rho_s)$}
        \UnaryInfC{$A_{\tau 1}, \ldots, A_{\tau n} \vdash B$}
        \DisplayProof
        &
        \tagarray{\label{tau_ex_ex}}
\end{tabular}
\end{center}
where $\tau$ is a permutation and $\sigma_1, \ldots, \sigma_r$ and $\rho_1,\ldots,\rho_s$ are sequences of transpositions of consecutive positions (one or both lists may be empty) with the property that $\sigma_1 \cdots \sigma_r = \tau = \rho_1 \cdots \rho_s$ in the permutation group. The two preproofs in \eqref{tau_ex_ex} are respectively the sequences of exchanges corresponding to the $\sigma_i$ and $\rho_j$.
\end{defn}
\begin{remark}
The point of $\tau$-equivalence is that the set of rules $\scr{X} := \lbrace \cut,\ex,\rimp,\limp,\ctr,\weak \rbrace$ consists of those which involve manipulating formulas whose position in the numerator cannot be recovered from the sequent in the denominator. The remaining rules do not have this property, so there is not $\tau$-equivalence rule for them.
\end{remark}
\subsection{Commuting equivalence}
Proofs, in the sense of Definition \ref{def:sequent_calc} are inherently sequential in that some order must be chosen for deduction rules which may be arbitrary. For instance, in the proof segment:
\begin{prooftree}
\AxiomC{$\Gamma, A, \Gamma', B, C, \Gamma'' \vdash D$}
\RightLabel{$\ex$}
\UnaryInfC{$\Gamma, A, \Gamma', C, B, \Gamma'' \vdash D$}
\RightLabel{$\rimp$}
\UnaryInfC{$\Gamma, \Gamma', C, B, \Gamma'' \vdash A \multimap D$}
\end{prooftree}
the displayed occurrences of $\ex$ and $\rimp$ are \emph{parallel} in a sense we now make precise:
\begin{defn}[Commuting equivalence]\label{def:commuting_equiv}
We define $\sim_c$ to be the smallest compatible equivalence relation on proofs generated by the following pairs of deduction rules, in what follows we assume that $(r_1),(r_2)$ are proper deduction rules:
\begin{itemize}
    \item when $(r_1),(r_2)$ are both unary and $(r_1)$ is a left rule and $(r_2)$ is a right rule which does not make use of the formula manipulated by $(r_1)$:
    \begin{center}
        \begin{tabular}{ >{\centering}m{5cm} >{\centering}m{0.5cm} >{\centering}m{5cm} >{\centering}m{0.5cm}}
            \AxiomC{$\Gamma \vdash A$}
            \RightLabel{$(r_1)$}
            \UnaryInfC{$\Delta \vdash A$}
            \RightLabel{$(r_2)$}
            \UnaryInfC{$\Theta \vdash A'$}
            \DisplayProof
            &
            $\sim_c$
            &
            \AxiomC{$\Gamma \vdash A$}
            \RightLabel{$(r_2)$}
            \UnaryInfC{$\Lambda \vdash A'$}
            \RightLabel{$(r_1)$}
            \UnaryInfC{$\Theta \vdash A'$}
            \DisplayProof
            &
            \tagarray{\label{com:unary_unary_left_right}}
        \end{tabular}
    \end{center}
    \item when $(r_1),(r_2)$ are both unary and both left rules, where $(r_2)$ does not manipulate the formula manipulated by $(r_1)$:
    \begin{center}
    \begin{tabular}{ >{\centering}m{5cm} >{\centering}m{0.5cm} >{\centering}m{5cm} >{\centering}m{0.5cm}}
        \begin{prooftree}
        \startproof{$\pi'$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \RightLabel{$(r_1)$}
        \UnaryInfC{$\Delta \vdash A$}
        \RightLabel{$(r_2)$}
        \UnaryInfC{$\Theta \vdash A$}
        \end{prooftree}
        &
        $\sim_c$
        &
        \begin{prooftree}
        \startproof{$\pi'$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \RightLabel{$(r_2)$}
        \UnaryInfC{$\Lambda \vdash A$}
        \RightLabel{$(r_1)$}
        \UnaryInfC{$\Theta \vdash A$}
        \end{prooftree}
        &
        \tagarray{\label{com:unary_unary_left_left}}
    \end{tabular}
\end{center}
\item when $(r_1)$ is unary and $(r_2)$ is binary, with $(r_1)$ a left rule and $(r_2)$ a right rule where $(r_2)$ does not make use of the formula manipulated by $(r_1)$:
\begin{center}
    \begin{tabular}{ >{\centering}m{7cm} >{\centering}m{0.5cm} >{\centering}m{7cm} >{\centering}m{0.5cm}}
        \begin{prooftree}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Theta \vdash B$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \RightLabel{$(r_1)$}
        \UnaryInfC{$\Delta \vdash A$}
        \RightLabel{$(r_2)$}
        \BinaryInfC{$\Lambda \vdash A'$}
        \end{prooftree}
        &
        $\sim_c$
        &
        \begin{prooftree}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Theta \vdash B$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \RightLabel{$(r_2)$}
        \BinaryInfC{$\Omega \vdash A'$}
        \RightLabel{$(r_1)$}
        \UnaryInfC{$\Lambda \vdash A'$}
        \end{prooftree}
        &
        \tagarray{\label{com:unary_binary_left_right}}
    \end{tabular}
\end{center}
\item when $(r_1)$ is unary and $(r_2)$ is binary, with $(r_1)$ a right rule and $(r_2)$ a left rule:
\begin{center}
    \begin{tabular}{ >{\centering}m{7cm} >{\centering}m{0.5cm} >{\centering}m{7cm} >{\centering}m{0.5cm}}
        \begin{prooftree}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Theta \vdash B$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \RightLabel{$(r_1)$}
        \UnaryInfC{$\Delta \vdash A'$}
        \RightLabel{$(r_2)$}
        \BinaryInfC{$\Lambda \vdash A'$}
        \end{prooftree}
        &
        $\sim_c$
        &
        \begin{prooftree}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Theta \vdash B$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \RightLabel{$(r_2)$}
        \BinaryInfC{$\Omega \vdash A$}
        \RightLabel{$(r_1)$}
        \UnaryInfC{$\Lambda\vdash A'$}
        \end{prooftree}
        &
        \tagarray{\label{com:unary_binary_right_left}}
    \end{tabular}
\end{center}
\item when $(r_1)$ is unary and $(r_2)$ is binary, with $(r_1)$ and $(r_2)$ both left rules where $(r_2)$ does not make use of the formula manipulated by $(r_1)$:
\begin{center}
    \begin{tabular}{ >{\centering}m{7cm} >{\centering}m{0.5cm} >{\centering}m{7cm} >{\centering}m{0.5cm}}
        \begin{prooftree}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Theta \vdash B$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \RightLabel{$(r_1)$}
        \UnaryInfC{$\Delta \vdash A$}
        \RightLabel{$(r_2)$}
        \BinaryInfC{$\Lambda \vdash A$}
        \end{prooftree}
        &
        $\sim_c$
        &
        \begin{prooftree}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Theta \vdash B$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \RightLabel{$(r_2)$}
        \BinaryInfC{$\Omega \vdash A$}
        \RightLabel{$(r_1)$}
        \UnaryInfC{$\Lambda \vdash A$}
        \end{prooftree}
        &
        \tagarray{\label{com:unary_binary_left_left}}
    \end{tabular}
\end{center}
\item the only commuting equivalence generator when $(r_1)$ and $(r_2)$ are binary, with $(r_1)$ a left rule and $(r_2)$ a right rule is when $(r_2) = \rtensor$:
\begin{center}
    \begin{tabular}{ >{\centering}m{7.5cm} >{\centering}m{0.5cm} >{\centering}m{7.5cm} >{\centering}m{0.5cm}}
        \begin{prooftree}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Theta \vdash B$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Gamma \vdash C$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Delta \vdash A$}
        \RightLabel{$(r_1)$}
        \BinaryInfC{$\Lambda \vdash A$}
        \RightLabel{$\rtensor$}
        \BinaryInfC{$\Theta, \Lambda \vdash B \otimes A$}
        \end{prooftree}
        &
        $\sim_c$
        &
        \begin{prooftree}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Theta \vdash B$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Gamma\vdash C$}
        \RightLabel{$\rtensor$}
        \BinaryInfC{$\Theta, \Gamma \vdash B \otimes A$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Delta \vdash A$}
        \RightLabel{$(r_1)$}
        \BinaryInfC{$\Theta, \Lambda \vdash B \otimes A$}
        \end{prooftree}
        &
        \tagarray{\label{com:binary_binary_left_right}}
    \end{tabular}
\end{center}
%\item There is also the following special case:
%\begin{center}
%    \begin{tabular}{ >{\centering}m{7.5cm} >{\centering}m{0.5cm} >{\centering}m{7.5cm} >{\centering}m{0.5cm}}
%        \startproof{$\pi_1$}
%        \noLine
%        \UnaryInfC{$\Gamma, !A, !A, \Gamma' \vdash B$}
%        \RightLabel{$\ctr$}
%        \UnaryInfC{$\Gamma, !A, \Gamma' \vdash B$}
%        \RightLabel{$\der$}
%        \UnaryInfC{$\Gamma, !!A, \Gamma' \vdash B$}
%        \DisplayProof
%        &
%        $\sim_c$
%        &
%        \startproof{$\pi_1$}
%        \UnaryInfC{$\Gamma, !A, !A, \Gamma' \vdash B$}
%        \RightLabel{$\der$}
%        \UnaryInfC{$\Gamma, !!A, !A, \Gamma' \vdash B$}
%        \RightLabel{$\der$}
%        \UnaryInfC{$\Gamma, !!A, !!A, \Gamma' \vdash B$}
%        \RightLabel{$\ctr$}
%        \UnaryInfC{$\Gamma, !!A, \Gamma' \vdash B$}
%        \DisplayProof
%        &
%        \tagarray{\label{com:ctr_der}}
%    \end{tabular}
%\end{center}
\end{itemize}
\end{defn}
So far we have excluded the rules $\rwith, \lplus$ from our consideration. Indeed these rules deserve special treatment as they require an agreed structure across the sequents in the numerator. The full system of Linear Logic \cite{linear_logic} identifies $\lplus$ with the negation of $\rwith$, thus these rules introduce similar equivalence relation generators:
\begin{defn}[\textbf{With equivalence}]\label{def:with_equivalence} We Define $\sim_w$ to be the smallest, compatible, equivalence relation on proofs satisfying:
\begin{itemize}
    \item where $(r)$ is a proper, left, unary rule:
    \begin{center}
    \begin{tabular}{ >{\centering}m{6.5cm} >{\centering}m{0.5cm} >{\centering}m{6.5cm} >{\centering}m{0.5cm}}
        \begin{prooftree}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Gamma \vdash B$}
        \RightLabel{$\rwith$}
        \BinaryInfC{$\Gamma \vdash A \& B$}
        \RightLabel{$(r)$}
        \UnaryInfC{$\Delta \vdash A \& B$}
        \end{prooftree}
        &
        $\sim_w$
        &
        \begin{prooftree}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \RightLabel{$(r)$}
        \UnaryInfC{$\Delta \vdash A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Gamma \vdash B$}
        \RightLabel{$(r)$}
        \UnaryInfC{$\Delta \vdash B$}
        \RightLabel{$\rwith$}
        \BinaryInfC{$\Delta \vdash A \& B$}
        \end{prooftree}
        &
        \tagarray{\label{with:unary}}
    \end{tabular}
\end{center}
    \item where $(r)$ is a proper, left, binary rule:
    \begin{center}
    \begin{tabular}{ >{\centering}m{6.5cm} >{\centering}m{0.5cm} >{\centering}m{8.6cm} >{\centering}m{0.5cm}}
        \begin{prooftree}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Theta \vdash C$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Gamma \vdash B$}
        \RightLabel{$\rwith$}
        \BinaryInfC{$\Gamma \vdash A \& B$}
        \RightLabel{$(r)$}
        \BinaryInfC{$\Delta \vdash A \& B$}
        \end{prooftree}
        &
        $\sim_w$
        &
        \begin{prooftree}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Theta \vdash C$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \RightLabel{$(r)$}
        \BinaryInfC{$\Delta \vdash A$}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Theta \vdash C$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Gamma \vdash B$}
        \RightLabel{$(r)$}
        \BinaryInfC{$\Delta \vdash B$}
        \RightLabel{$\rwith$}
        \BinaryInfC{$\Delta \vdash A \& B$}
        \end{prooftree}
        &
        \tagarray{\label{with:binary}}
    \end{tabular}
\end{center}
\item where $(r)$ is a proper, left, unary rule which does not manipulate the formula introduced by $\lplus$:
\begin{center}
    \begin{tabular}{ >{\centering}m{6.5cm} >{\centering}m{0.5cm} >{\centering}m{6.5cm} >{\centering}m{0.5cm}}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Gamma, A, \Gamma' \vdash C$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Gamma, B, \Gamma' \vdash C$}
        \RightLabel{$\lplus$}
        \BinaryInfC{$\Gamma, A \oplus B, \Gamma' \vdash C$}
        \RightLabel{$(r)$}
        \UnaryInfC{$\Delta, A \oplus B, \Delta' \vdash C$}
        \DisplayProof
        &
        $\sim_w$
        &
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Gamma, A, \Gamma' \vdash C$}
        \RightLabel{$(r)$}
        \UnaryInfC{$\Delta, A, \Delta' \vdash C$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Gamma, B, \Gamma' \vdash C$}
        \RightLabel{$(r)$}
        \UnaryInfC{$\Delta, B, \Delta' \vdash C$}
        \RightLabel{$\lplus$}
        \BinaryInfC{$\Delta, A \oplus B, \Delta' \vdash C$}
        \DisplayProof
        &
        \tagarray{\label{with:lplus_left_unary_non_manip}}
    \end{tabular}
\end{center}
\item where $(r)$ is a proper, right, unary rule which does not manipulate the formula introduced by $\lplus$:
\begin{center}
    \begin{tabular}{ >{\centering}m{6.5cm} >{\centering}m{0.5cm} >{\centering}m{6.5cm} >{\centering}m{0.5cm}}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Gamma, A, \Gamma' \vdash C$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Gamma, B, \Gamma' \vdash C$}
        \RightLabel{$\lplus$}
        \BinaryInfC{$\Gamma, A \oplus B, \Gamma' \vdash C$}
        \RightLabel{$(r)$}
        \UnaryInfC{$\Delta, A \oplus B, \Delta' \vdash C'$}
        \DisplayProof
        &
        $\sim_w$
        &
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Gamma, A, \Gamma' \vdash C$}
        \RightLabel{$(r)$}
        \UnaryInfC{$\Delta, A, \Delta' \vdash C'$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Gamma, B, \Gamma' \vdash C$}
        \RightLabel{$(r)$}
        \UnaryInfC{$\Delta, B, \Delta' \vdash C'$}
        \RightLabel{$\lplus$}
        \BinaryInfC{$\Delta, A \oplus B, \Delta' \vdash C'$}
        \DisplayProof
        &
        \tagarray{\label{with:lplus_right_unary_non_manip}}
    \end{tabular}
\end{center}
\item where $(r)$ is a proper, left, binary rule (of which there is only one: $\limp$) which does not manipulate the formula introduced by $\lplus$:
\begin{center}
    \begin{tabular}{>{\centering}m{15cm} >{\centering}m{1cm}}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Theta \vdash D$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Gamma, E, \Gamma', A, \Gamma'' \vdash C$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Gamma, E, \Gamma', B, \Gamma'' \vdash C$}
        \RightLabel{$\lplus$}
        \BinaryInfC{$\Gamma, E, \Gamma', A \oplus B, \Gamma'' \vdash C$}
        \RightLabel{$\limp$}
        \BinaryInfC{$D \multimap E, \Theta, \Gamma, \Gamma' A \oplus B, \Gamma'' \vdash C$}
        \DisplayProof\\\vspace{0.5cm}
        $\sim_w$\\\vspace{0.5cm}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Theta \vdash D$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Gamma, E, \Gamma', A, \Gamma'' \vdash C$}
        \RightLabel{$\limp$}
        \BinaryInfC{$D \multimap E, \Gamma, \Gamma', A, \Gamma'' \vdash C$}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Theta \vdash D$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Gamma, E, \Gamma', B, \Gamma'' \vdash C$}
        \RightLabel{$\limp$}
        \BinaryInfC{$D \multimap E, \Gamma, \Gamma', B, \Gamma'' \vdash C$}
        \RightLabel{$\lplus$}
        \BinaryInfC{$D \multimap E, \Gamma, \Gamma', B, \Gamma'' \vdash C$}
        \DisplayProof
        &
        \tagarray{\label{with:lplus_limp}}
    \end{tabular}
\end{center}
\item where $(r)$ is the rule $\rtensor$:
\begin{center}
    \begin{tabular}{>{\centering}m{15cm} >{\centering}m{1cm}}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Delta, B_1, \Delta' \vdash C$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Delta, B_2, \Delta' \vdash C$}
        \RightLabel{$\lplus$}
        \BinaryInfC{$\Delta, B_1 \oplus B_2, \Delta' \vdash C$}
        \RightLabel{$\rtensor$}
        \BinaryInfC{$\Gamma, \Delta, B_1, \oplus B_2, \Delta' \vdash A \otimes C$}
        \DisplayProof\\\vspace{0.5cm}
        $\sim_w$\\\vspace{0.5cm}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Delta, B_1, \Delta' \vdash C$}
        \RightLabel{$\rtensor$}
        \BinaryInfC{$\Gamma, \Delta, B_1, \Delta' \vdash A \otimes C$}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{${\pi_3}$}
        \noLine
        \UnaryInfC{$\Delta, B_2, \Delta' \vdash C$}
        \RightLabel{$\rtensor$}
        \BinaryInfC{$\Gamma, \Delta, B_2, \Delta' \vdash A \otimes C$}
        \RightLabel{$\lplus$}
        \BinaryInfC{$\Gamma, \Delta, B_1 \oplus B_2, \Delta' \vdash A \otimes C$}
        \DisplayProof
        &
        \tagarray{\label{with:lplus_on_right_rtensor}}
    \end{tabular}
\end{center}
and
\begin{center}
    \begin{tabular}{>{\centering}m{15cm} >{\centering}m{1cm}}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Gamma, A_1, \Gamma' \vdash A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Gamma, A_2, \Gamma' \vdash A$}
        \RightLabel{$\lplus$}
        \BinaryInfC{$\Gamma, A_1 \oplus A_2, \Gamma' \vdash A$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Delta \vdash B$}
        \RightLabel{$\rtensor$}
        \BinaryInfC{$\Gamma, A_1 \oplus A_2, \Gamma', \Delta \vdash A \otimes B$}
        \DisplayProof\\\vspace{0.5cm}
        $\sim_w$\\\vspace{0.5cm}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Gamma, A_1, \Gamma' \vdash A$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Delta \vdash B$}
        \RightLabel{$\rtensor$}
        \BinaryInfC{$\Gamma, A_1, \Gamma', \Delta \vdash A \otimes B$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Gamma, A_2, \Gamma' \vdash A$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Delta \vdash B$}
        \RightLabel{$\rtensor$}
        \BinaryInfC{$\Gamma, A_2, \Gamma', \Delta \vdash A \otimes B$}
        \RightLabel{$\lplus$}
        \BinaryInfC{$\Gamma, A_1 \oplus A_2, \Gamma', \Delta \vdash A \otimes B$}
        \DisplayProof
        &
        \tagarray{\label{with:lplus_on_left_rtensor}}
    \end{tabular}
\end{center}
%\item We can also commute $\rwith$ beneath $\ltensor$ in a very special case:
%\begin{center}
%    \begin{tabular}{>{\centering}m{15cm} >{\centering}m{1cm}}
%        \startproof{$\pi_1$}
%        \noLine
%        \UnaryInfC{$\Gamma, A, \Gamma' \vdash C \& D$}
%        \startproof{$\pi_2$}
%        \noLine
%        \UnaryInfC{$\Gamma, B, \Gamma' \vdash C$}
%        \startproof{$\pi_3$}
%        \noLine
%        \UnaryInfC{$\Gamma, B, \Gamma' \vdash D$}
%        \RightLabel{$\rwith$}
%        \BinaryInfC{$\Gamma, B, \Gamma' \vdash C \& D$}
%        \RightLabel{$\lplus$}
%        \BinaryInfC{$\Gamma, A \oplus B, \Gamma' \vdash C \& C$}
%        \DisplayProof\\\vspace{0.5cm}
%        $\sim_w$\\\vspace{0.5cm}
%        \startproof{$\pi_1$}
%        \noLine
%        \UnaryInfC{$\Gamma, A, \Gamma' \vdash C \& D$}
%        \startproof{$\pi_2$}
%        \noLine
%        \UnaryInfC{$\Gamma, B, \Gamma' \vdash D$}
%        \RightLabel{$\lplus$}
%        \BinaryInfC{$\Gamma, A \oplus B, \Gamma' \vdash C$}
%        \startproof{$\pi_1$}
%        \noLine
%        \UnaryInfC{$\Gamma, A, \Gamma' \vdash C$}
%        \startproof{$\pi_3$}
%        \noLine
%        \UnaryInfC{$\Gamma, B, \Gamma' \vdash C$}
%        \RightLabel{$\lplus$}
%        \BinaryInfC{$\Gamma, A \oplus B, \Gamma' \vdash C$}
%        \RightLabel{$\rwith$}
%        \BinaryInfC{$\Gamma, A \oplus B, \Gamma' \vdash C \& C$}
%        \DisplayProof
%        &
%        \tagarray{\label{with:rwith_lplus}}
%    \end{tabular}
%\end{center}
\end{itemize}
\end{defn}
\begin{remark}\label{rmk:gridlocked}
The following proof $\pi$ cannot have either the two occurrences of $\der$ brought beneath the occurrence of $\rwith$, which shows that the left branch and the right branch are \emph{not} equivalent proofs.
\begin{prooftree}
\AxiomC{}
\RightLabel{$\ax$}
\UnaryInfC{$A \vdash A$}
\RightLabel{$\weak$}
\UnaryInfC{$A, !B \vdash A$}
\RightLabel{$\der$}
\UnaryInfC{$!A, !B \vdash A$}
\AxiomC{}
\RightLabel{$\ax$}
\UnaryInfC{$B \vdash B$}
\RightLabel{$\weak$}
\UnaryInfC{$!A, B \vdash B$}
\RightLabel{$\der$}
\UnaryInfC{$!A, !B \vdash B$}
\RightLabel{$\rwith$}
\BinaryInfC{$!A, !B \vdash A \& B$}
\end{prooftree}
The occurrence of $\rwith$ cannot be brought beneath the $\lplus$ in the following proof:
\begin{prooftree}
\AxiomC{}
\RightLabel{$\ax$}
\UnaryInfC{$A \& B \vdash A \& B$}
\RightLabel{$\weak$}
\UnaryInfC{$!A, A \& B \vdash A \& B$}
\startproof{$\pi$}
\noLine
\UnaryInfC{$!A, !B \vdash A \& B$}
\RightLabel{$\lplus$}
\BinaryInfC{$!A, (A \& B) \oplus !B \vdash A \& B$}
\end{prooftree}
In the following proof, the occurrence of $\lplus$ cannot be brought beneath the occurrence of $\rwith$:
\begin{prooftree}
\AxiomC{}
\RightLabel{$\ax$}
\UnaryInfC{$A \oplus A \vdash A \oplus A$}
\AxiomC{}
\RightLabel{$\ax$}
\UnaryInfC{$A \vdash A$}
\AxiomC{}
\RightLabel{$\ax$}
\UnaryInfC{$A \vdash A$}
\RightLabel{$\lplus$}
\BinaryInfC{$A \oplus A \vdash A$}
\RightLabel{$\rwith$}
\BinaryInfC{$A \oplus A \vdash (A \oplus A) \& A$}
\end{prooftree}
Thus $\lplus$ does \emph{not} commute downwards past $\rwith$.
\end{remark}
Loosely speaking, moving an occurrence of an $\rwith$ rule beneath a deduction rule $(r)$ via with-equivalence involves copying the rule $(r)$ and appending $(r)$ to the bottom of each branch of the $\rwith$ occurrence. Reading this backwards, we see that if the two branches $\pi_1,\pi_2$ of an $\rwith$ rule admit ``the same" last step then this rule can be brought beneath the $\rwith$ rule. We can use this structure to define a measure of how much two $\rwith,\lplus$-free proofs $\pi_1,\pi_2$ differ.
\begin{defn}
Let $\pi$ be a proof with exactly one occurrence of $\rwith$ and no occurrences of $\lplus$, the \textbf{$\&$-height} is the height of this occurrence, which we denote $h_{\&}(\pi)$.

Let $\pi_1,\pi_2$ be two $\rwith$-free proofs of $\Gamma \vdash A$ and let $(\pi_1 |_{\&} \pi_2)$ denote the proof
\begin{prooftree}
\startproof{$\pi_1$}
\noLine
\UnaryInfC{$\Gamma \vdash A$}
\startproof{$\pi_2$}
\noLine
\UnaryInfC{$\Gamma \vdash A$}
\RightLabel{$\rwith$}
\BinaryInfC{$\Gamma \vdash A$}
\end{prooftree}
The \textbf{degree of distinction} between these proofs is the integer
\begin{equation}
    \operatorname{Distinct}(\pi_1,\pi_2) := h(\pi) - \sup \lbrace h_{\&}(\pi) \mid \pi \sim_p (\pi_1 |_{\&} \pi_2)\rbrace
\end{equation}
\end{defn}
\begin{example}
The left and right branches of the proof given in Remark \ref{rmk:gridlocked} is $3 - 0 = 3$.
\end{example}
\begin{remark}
One could also consider the pair $\big(h(\pi_1) + 1 - \operatorname{Distinct}(\pi_1,\pi_2),h(\pi_2) + 1 - \operatorname{Distinct}(\pi_1,\pi_2)\big)$.
\end{remark}
The organisation of these equivalence relations helps to conceptualise them as there are so many different relations. The following appears to reflect a \emph{co-algebraic structure} so we endow it \emph{co-equivalence}:
\begin{defn}[\textbf{\emph{co}-equivalence}]\label{def:co-equivalence}
We define $\sim_{\operatorname{co}}$ to be the smallest, compatible equivalence relation satisfying the following:
\begin{center}
    \begin{tabular}{ >{\centering}m{7.1cm} >{\centering}m{0.5cm} >{\centering}m{7.1cm} >{\centering}m{0.5cm}}
        \AxiomC{$\Gamma, \textcolor{blue}{!A, !A,} !A, \Gamma' \vdash B$}
        \RightLabel{$\ctr$}
        \UnaryInfC{$\Gamma, !A, !A, \Gamma' \vdash B$}
        \RightLabel{$\ctr$}
        \UnaryInfC{$\Gamma, !A, \Gamma' \vdash B$}
        \DisplayProof
        &
        $\sim_{\operatorname{co}}$
        &
        \AxiomC{$\Gamma, !A, \textcolor{blue}{!A, !A,} \Gamma' \vdash B$}
        \RightLabel{$\ctr$}
        \UnaryInfC{$\Gamma, !A, !A, \Gamma' \vdash B$}
        \RightLabel{$\ctr$}
        \UnaryInfC{$\Gamma, !A, \Gamma' \vdash B$}
        \DisplayProof
        &
        \tagarray{\label{co:associative}}
    \end{tabular}
\end{center}

\begin{center}
    \begin{tabular}{ >{\centering}m{7.1cm} >{\centering}m{0.5cm} >{\centering}m{7.1cm} >{\centering}m{0.5cm}}
        \AxiomC{$\Gamma, !A, !A, \Gamma' \vdash B$}
        \RightLabel{$\ctr$}
        \UnaryInfC{$\Gamma, !A, \Gamma' \vdash B$}
        \DisplayProof
        &
        $\sim_{\operatorname{co}}$
        &
        \AxiomC{$\Gamma, !A, !A, \Gamma' \vdash B$}
        \RightLabel{$\ex$}
        \UnaryInfC{$\Gamma, !A, !A, \Gamma' \vdash B$}
        \RightLabel{$\ctr$}
        \UnaryInfC{$\Gamma, !A, \Gamma' \vdash B$}
        \DisplayProof
        &
        \tagarray{\label{co:commutative}}
    \end{tabular}
\end{center}

\begin{center}
    \begin{tabular}{ >{\centering}m{7.1cm} >{\centering}m{0.5cm} >{\centering}m{7.1cm} >{\centering}m{0.5cm}}
        \AxiomC{$\Gamma, !A, \Gamma' \vdash B$}
        \DisplayProof
        &
        $\sim_{\operatorname{co}}$
        &
        \AxiomC{$\Gamma, !A, \Gamma' \vdash B$}
        \RightLabel{$\weak$}
        \UnaryInfC{$\Gamma, !A, !A, \Gamma' \vdash B$}
        \RightLabel{$\ctr$}
        \UnaryInfC{$\Gamma, !A, \Gamma' \vdash B$}
        \DisplayProof
        &
        \tagarray{\label{co:unit}}
    \end{tabular}
\end{center}
where \eqref{co:associative} is co-associativity, \eqref{co:commutative} is co-commutativity, and \eqref{co:unit} is the co-unit.
\end{defn}
\subsection{Cut reduction steps}
So far we have defined equivalence relations but reading each equivalence relation generator from left to right can be thought of as providing a \emph{computational step}. To emphasise the computational interpretation of $\cut$-elimination (Theorem \ref{Thm:cut_reduction}) we define the following \emph{not} as an equivalence relation but as a series of \emph{reduction steps}:
\begin{defn}[\textbf{Single step cut reduction}]\label{def:cut_reduction}
We define $\sim_{\operatorname{cut}}$ to be the smallest compatible relation (not necessarily an equivalence relation) on preproofs containing:
\begin{itemize}
    \item For any proper deduction rule $(r)$
\begin{center}
\begin{tabular}{ >{\centering}m{7cm} >{\centering}m{0.5cm} >{\centering}m{4cm} >{\centering}m{0.5cm}} 
        \AxiomC{}
        \RightLabel{$({\operatorname{ax}})$}
        \UnaryInfC{$A \vdash A$}
        \AxiomC{$\pi$}
        \noLine
        \UnaryInfC{$\vdots$}
        \RightLabel{$(r)$}
        \UnaryInfC{$A, \Gamma \vdash B$}
        \RightLabel{$({\operatorname{cut}})$}
        \BinaryInfC{$A, \Gamma \vdash B$}
        \DisplayProof
        & $\to_{\operatorname{cut}}$ &
        \AxiomC{$\pi$}
        \noLine
        \UnaryInfC{$\vdots$}
        \RightLabel{$(r)$}
        \UnaryInfC{$A, \Gamma \vdash B$}
        \DisplayProof
        & \tagarray{\label{cut:ax_left}}
\end{tabular}
\end{center}

\begin{center}
\begin{tabular}{>{\centering}m{7cm} >{\centering}m{0.5cm} >{\centering}m{4cm} >{\centering}m{0.5cm}} 
        \AxiomC{$\pi$}
        \noLine
        \UnaryInfC{$\vdots$}
        \RightLabel{$(r)$}
        \UnaryInfC{$\Gamma\vdash A$}
        \AxiomC{}
        \RightLabel{$({\operatorname{ax}})$}
        \UnaryInfC{$A \vdash A$}
        \RightLabel{$({\operatorname{cut}})$}
        \BinaryInfC{$\Gamma\vdash A$}
        \DisplayProof
        & $\to_{\operatorname{cut}}$ &
        \AxiomC{$\pi$}
        \noLine
        \UnaryInfC{$\vdots$}
        \RightLabel{$(r)$}
        \UnaryInfC{$\Gamma\vdash A$}
        \DisplayProof
        & \tagarray{\label{cut:ax_right}}
\end{tabular}
\end{center}

\item Those involving the right introduction rules for constants:
\begin{center}
    \begin{tabular}{>{\centering}m{7cm} >{\centering}m{0.5cm} >{\centering}m{7cm} >{\centering}m{0.5cm}}
        \AxiomC{}
        \RightLabel{$\rone$}
        \UnaryInfC{$\vdash \bold{1}$}
        \startproof{$\pi$}
        \UnaryInfC{$\Gamma, \bold{1}, \Gamma' \vdash A$}
        \RightLabel{$(r)$}
        \UnaryInfC{$\Delta, \bold{1},\Delta' \vdash A$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Delta, \Delta' \vdash A$}
        \DisplayProof
        &
        $\to_{\operatorname{cut}}$
        &
        \AxiomC{}
        \RightLabel{$\rone$}
        \UnaryInfC{$\vdash \bold{1}$}
        \startproof{$\pi$}
        \UnaryInfC{$\Gamma, \bold{1}, \Gamma' \vdash A$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Gamma' \vdash A$}
        \RightLabel{$(r)$}
        \UnaryInfC{$\Delta, \Delta' \vdash A$}
        \DisplayProof
        &
        \tagarray{\label{cut:one}}
    \end{tabular}
\end{center}
\begin{center}
    \begin{tabular}{>{\centering}m{7cm} >{\centering}m{0.5cm} >{\centering}m{8cm} >{\centering}m{0.5cm}}
        \AxiomC{}
        \RightLabel{$\rtrue$}
        \UnaryInfC{$\Gamma \vdash \top$}
        \startproof{$\pi$}
        \UnaryInfC{$\Delta, \top, \Delta' \vdash A$}
        \RightLabel{$(r)$}
        \UnaryInfC{$\Theta, \top,\Theta' \vdash A$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Theta, \Theta' \vdash A$}
        \DisplayProof
        &
        $\to_{\operatorname{cut}}$
        &
        \AxiomC{}
        \RightLabel{$\rtrue$}
        \UnaryInfC{$\Gamma \vdash \top$}
        \startproof{$\pi$}
        \UnaryInfC{$\Delta, \top, \Delta' \vdash A$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Delta, \Delta' \vdash A$}
        \RightLabel{$(r)$}
        \UnaryInfC{$\Theta, \Theta' \vdash A$}
        \DisplayProof
        &
        \tagarray{\label{cut:one}}
    \end{tabular}
\end{center}
\item Let $(r)$ be any proper deduction rule. Then
\begin{center}
    \begin{tabular}{>{\centering}m{7cm} >{\centering}m{0.5cm} >{\centering}m{5cm} >{\centering}m{0.5cm}}
    \startproof{$\pi_1$}
    \RightLabel{$(r)$}
    \UnaryInfC{$\Gamma \vdash A$}
    \AxiomC{}
    \RightLabel{$\rtrue$}
    \UnaryInfC{$\Delta, A, \Delta' \vdash \true$}
    \RightLabel{$\cut$}
    \BinaryInfC{$\Gamma, \Delta, \Delta' \vdash \true$}
    \DisplayProof
    &
    $\to_{\operatorname{cut}}$
    &
    \AxiomC{}
    \RightLabel{$\rtrue$}
    \UnaryInfC{$\Gamma, \Delta, \Delta' \vdash \true$}
    \DisplayProof
    &
    \tagarray{\label{cut:any_true}}
    \end{tabular}
\end{center}
    \item Let $(r_0)$ be any structural rule or any unary left logical rule and $(r)$ any proper deduction rule. Then:
\begin{center}
\begin{tabular}{>{\centering}m{6.5cm} >{\centering}m{0.5cm} >{\centering}m{8cm} >{\centering}m{0.5cm}}
        \AxiomC{$\pi_1$}
        \noLine
        \UnaryInfC{$\vdots$}
        \UnaryInfC{$\Gamma \vdash A$}
        \RightLabel{$(r_0)$}
        \UnaryInfC{$\Theta \vdash A$}
        \AxiomC{$\pi_2$}
        \noLine
        \UnaryInfC{$\vdots$}
        \RightLabel{$(r)$}
        \UnaryInfC{$\Delta, A, \Delta' \vdash B$}
        \RightLabel{$({\operatorname{cut}})$}
        \BinaryInfC{$\Theta, \Delta, \Delta' \vdash B$}
        \DisplayProof
        &$\to_{\operatorname{cut}}$&
        \AxiomC{$\pi_1$}
        \noLine
        \UnaryInfC{$\vdots$}
        \UnaryInfC{$\Gamma \vdash A$}
        \AxiomC{$\pi_2$}
        \noLine
        \UnaryInfC{$\vdots$}
        \RightLabel{$(r)$}
        \UnaryInfC{$\Delta, A, \Delta' \vdash B$}
        \RightLabel{$({\operatorname{cut}})$}
        \BinaryInfC{$\Gamma, \Delta, \Delta' \vdash B$}
        \RightLabel{$(r_0)$}
        \UnaryInfC{$\Theta, \Delta, \Delta' \vdash B$}
        \DisplayProof
        & \tagarray{\label{cut:struc_or_unary_left_log_vs_any}}
\end{tabular}
\end{center}
\item $(r_1)$ be any binary left logical rule and $(r)$ any proper deduction rule:
\begin{center}
    \begin{tabular}{>{\centering}m{10cm} >{\centering}m{1cm}}
        \startproof{$\pi_1$}
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \UnaryInfC{$\Delta \vdash C$}
        \RightLabel{$(r_1)$}
        \BinaryInfC{$\Theta \vdash C$}
        \startproof{$\pi_3$}
        \RightLabel{$(r)$}
        \UnaryInfC{$\Lambda, C, \Lambda' \vdash D$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Theta, \Lambda, \Lambda' \vdash D$}
        \DisplayProof\\\vspace{0.5cm}
        $\to_{\operatorname{cut}}$\\\vspace{0.5cm}
        \startproof{$\pi_1$}
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \UnaryInfC{$\Delta \vdash C$}
        \startproof{$\pi_3$}
        \RightLabel{$(r)$}
        \UnaryInfC{$\Lambda, C, \Lambda' \vdash D$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Delta, \Lambda, \Lambda' \vdash D$}
        \RightLabel{$(r_1)$}
        \BinaryInfC{$\Theta, \Lambda, \Lambda' \vdash D$}
        \DisplayProof
        &
        \tagarray{\label{cut:bin_left_log_vs_any}}
    \end{tabular}
\end{center}
\item If $(r_1)$ is any logical rule or $\prom$ and $(r_2)$ is any unary, left, logical rule, or any structural rule, given the formula manipulated by $(r_2)$ is not the cut formula. Then:
\begin{center}
    \begin{tabular}{>{\centering}m{6.5cm} >{\centering}m{0.5cm} >{\centering}m{7cm} >{\centering}m{0.5cm}}
        \startproof{$\pi_1$}
        \RightLabel{$(r_1)$}
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Delta, A, \Delta' \vdash B$}
        \RightLabel{$(r_2)$}
        \UnaryInfC{$\Theta, A, \Theta' \vdash B$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Theta, \Theta' \vdash B$}
        \DisplayProof
        &
        $\to_{\operatorname{cut}}$
        &
        \startproof{$\pi_1$}
        \RightLabel{$(r_1)$}
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Delta, A, \Delta' \vdash B$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Delta, \Delta' \vdash B$}
        \RightLabel{$(r_2)$}
        \UnaryInfC{$\Gamma, \Theta, \Theta' \vdash B$}
        \DisplayProof
        &
        \tagarray{\label{cut:log_or_prom_vs_unary_left_log_or_struct_not_manip}}
    \end{tabular}
\end{center}
%\item If $(r_1)$ is any right logical rule and $(r_2)$ is any unary left logical rule where the formula manipulated by $(r_2)$ is not the cut formula. Then:
%\begin{center}
%    \begin{tabular}{>{\centering}m{6.5cm} >{\centering}m{0.5cm} >{\centering}m{6cm} >{\centering}m{0.5cm}}
%        \startproof{$\pi_1$}
%        \RightLabel{$(r_1)$}
%        \UnaryInfC{$\Gamma \vdash A$}
%        \startproof{$\pi_2$}
%        \noLine
%        \UnaryInfC{$\Delta, A, \Delta' \vdash B$}
%        \RightLabel{$(r_2)$}
%        \UnaryInfC{$\Theta, A, \Theta' \vdash B$}
%        \RightLabel{$\cut$}
%        \BinaryInfC{$\Gamma, \Theta, \Theta' \vdash B$}
%        \DisplayProof
%        &
%        $\to_{\operatorname{cut}}$
%        &
%        \startproof{$\pi_1$}
%        \RightLabel{$(r_1)$}
%        \UnaryInfC{$\Gamma \vdash A$}
%        \startproof{$\pi_2$}
%        \RightLabel{$(r_2)$}
%        \UnaryInfC{$\Delta, A, \Delta' \vdash B$}
%        \RightLabel{$\cut$}
%        \BinaryInfC{$\Gamma, \Delta, \Delta' \vdash B$}
%        \RightLabel{$(r_2)$}
%        \UnaryInfC{$\Gamma, \Theta, \Theta' \vdash B$}
%        \DisplayProof
%        &
%        \tagarray{\label{cut:}}
%    \end{tabular}
%\end{center}
\item If $(r_1)$ is any right logical rule or $\prom$ and $(r_2)$ is any binary left logical rule where the formula manipulated by $(r_2)$ is not the cut formula. Then:
\begin{center}
    \begin{tabular}{>{\centering}m{10cm} >{\centering}m{1cm}}
        \startproof{$\pi_1$}
        \RightLabel{$(r_1)$}
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Delta, A, \Delta' \vdash B$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Theta \vdash C$}
        \RightLabel{$(r_2)$}
        \BinaryInfC{$\Lambda, A, \Lambda' \vdash C$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Lambda, \Lambda' \vdash C$}
        \DisplayProof\\\vspace{0.5cm}
        $\to_{\operatorname{cut}}$\\\vspace{0.5cm}
        \startproof{$\pi_1$}
        \RightLabel{$(r_1)$}
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Delta, A, \Delta' \vdash B$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Delta, \Delta' \vdash B$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Theta \vdash C$}
        \RightLabel{$(r_2)$}
        \BinaryInfC{$\Gamma, \Lambda, \Lambda' \vdash C$}
        \DisplayProof
        &
        \tagarray{\label{cut:log_vs_bin_left_log_one}}
    \end{tabular}
\end{center}
and
\begin{center}
    \begin{tabular}{>{\centering}m{10cm} >{\centering}m{1cm}}
        \startproof{$\pi_1$}
        \RightLabel{$(r_1)$}
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Delta \vdash B$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Theta, A, \Theta' \vdash C$}
        \RightLabel{$(r_2)$}
        \BinaryInfC{$\Lambda, A, \Lambda' \vdash C$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Lambda, \Lambda' \vdash C$}
        \DisplayProof\\\vspace{0.5cm}
        $\to_{\operatorname{cut}}$\\\vspace{0.5cm}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Delta \vdash B$}
        \startproof{$\pi_1$}
        \RightLabel{$(r_1)$}
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Theta, A, \Theta' \vdash C$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Theta, \Theta' \vdash C$}
        \RightLabel{$(r_2)$}
        \BinaryInfC{$\Gamma, \Lambda, \Lambda' \vdash C$}
        \DisplayProof
        &
        \tagarray{\label{cut:log_vs_bin_left_log_two}}
    \end{tabular}
\end{center}
\item $(r)$ is any proper deduction rule, and $(r_1)$ is any unary right logical rule. Then:
\begin{center}
    \begin{tabular}{>{\centering}m{6.5cm} >{\centering}m{0.5cm} >{\centering}m{7cm} >{\centering}m{0.5cm}}
        \startproof{$\pi_1$}
        \RightLabel{$(r)$}
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Delta, A, \Delta' \vdash B$}
        \RightLabel{$(r_1)$}
        \UnaryInfC{$\Theta, A, \Theta' \vdash C$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Theta, \Theta' \vdash C$}
        \DisplayProof
        &
        $\to_{\operatorname{cut}}$
        &
        \startproof{$\pi_1$}
        \RightLabel{$(r)$}
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Delta, A, \Delta' \vdash B$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Delta, \Delta' \vdash B$}
        \RightLabel{$(r_1)$}
        \UnaryInfC{$\Gamma, \Theta, \Theta' \vdash C$}
        \DisplayProof
        &
        \tagarray{\label{cut:any_unary_rlog}}
    \end{tabular}
\end{center}
\item If $(r)$ is any proper deduction rule and $(r_1)$ is any binary right logical rule other than $\rwith$. Then:
\begin{center}
    \begin{tabular}{>{\centering}m{10cm} >{\centering}m{1cm}}
        \startproof{$\pi_1$}
        \RightLabel{$(r)$}
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Delta, A, \Delta' \vdash B$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Theta \vdash C$}
        \RightLabel{$(r_1)$}
        \BinaryInfC{$\Lambda, A, \Lambda' \vdash D$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Lambda, \Lambda' \vdash D$}
        \DisplayProof\\\vspace{0.5cm}
        $\to_{\operatorname{cut}}$\\\vspace{0.5cm}
        \startproof{$\pi_1$}
        \RightLabel{$(r)$}
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Delta, A, \Delta' \vdash B$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Delta, \Delta' \vdash B$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Theta \vdash C$}
        \RightLabel{$(r_1)$}
        \BinaryInfC{$\Gamma, \Lambda, \Lambda' \vdash D$}
        \DisplayProof
        &
        \tagarray{\label{cut:any_vs_bin_right_log_one}}
    \end{tabular}
\end{center}
and
\begin{center}
    \begin{tabular}{>{\centering}m{10cm} >{\centering}m{1cm}}
        \startproof{$\pi_1$}
        \RightLabel{$(r)$}
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Delta \vdash B$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Theta, A, \Theta' \vdash C$}
        \RightLabel{$(r_1)$}
        \BinaryInfC{$\Lambda, A, \Lambda' \vdash D$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Lambda, \Lambda' \vdash D$}
        \DisplayProof\\\vspace{0.5cm}
        $\to_{\operatorname{cut}}$\\\vspace{0.5cm}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Delta \vdash B$}
        \startproof{$\pi_1$}
        \RightLabel{$(r)$}
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Theta, A, \Theta' \vdash C$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Theta, \Theta' \vdash C$}
        \RightLabel{$(r_1)$}
        \BinaryInfC{$\Gamma, \Lambda, \Lambda' \vdash D$}
        \DisplayProof
        &
        \tagarray{\label{cut:any_vs_bin_right_log_two}}
    \end{tabular}
\end{center}
The remaining rules are the heart of the matter, they consist of the situations where the reduction step introduces an occurrence of $\cut$, or the cut formula is manipulated by the last rule of the right branch.
\item We have:
\begin{center}
    \begin{tabular}{>{\centering}m{10cm} >{\centering}m{1cm}}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Delta, A, \Delta' \vdash B$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Delta, A, \Delta' \vdash C$}
        \RightLabel{$\rwith$}
        \BinaryInfC{$\Delta, A, \Delta' \vdash B \& C$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Delta, \Delta' \vdash B \& C$}
        \DisplayProof\\\vspace{0.5cm}
        $\to_{\operatorname{cut}}$\\\vspace{0.5cm}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Delta, A, \Delta' \vdash B$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Delta, \Delta'$}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Delta, A, \Delta' \vdash C$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Delta, \Delta \vdash C$}
        \RightLabel{$\rwith$}
        \BinaryInfC{$\Gamma, \Delta, \Delta' \vdash B \& C$}
        \DisplayProof
        &
        \tagarray{\label{cut:any_rwith}}
    \end{tabular}
\end{center}
\item Also,
\begin{center}
    \begin{tabular}{>{\centering}m{15cm} >{\centering}m{1cm}}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Delta,A, \Delta', B_1, \Delta'' \vdash C$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Delta, A, \Delta', B_2, \Delta'' \vdash C$}
        \RightLabel{$\lplus$}
        \BinaryInfC{$\Delta, A, \Delta', B_1 \oplus B_2, \Delta'' \vdash C$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Delta, \Delta', B_1 \oplus B_2, \Delta'' \vdash C$}
        \DisplayProof\\\vspace{0.5cm}
        $\to_{\operatorname{cut}}$\\\vspace{0.5cm}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Delta, A, \Delta', B_1, \Delta'' \vdash C$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Delta, \Delta', B_1, \Delta'' \vdash C$}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Delta, A, \Delta', B_2, \Delta'' \vdash C$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Delta, \Delta', B_2, \Delta'' \vdash C$}
        \RightLabel{$\lplus$}
        \BinaryInfC{$\Gamma, \Delta, \Delta', B_1 \oplus B_2, \Delta'' \vdash C$}
        \DisplayProof
        &
        \tagarray{\label{cut:irrelevant_lplus}}
    \end{tabular}
\end{center}
\item let $(r)$ be any proper deduction rule. Then:
\begin{center}
    \begin{tabular}{>{\centering}m{8cm} >{\centering}m{0.5cm} >{\centering}m{7cm} >{\centering}m{0.5cm}}
        \startproof{$\pi_1$}
        \RightLabel{$(r)$}
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Delta, A, B, \Delta' \vdash C$}
        \RightLabel{$\ex$}
        \UnaryInfC{$\Delta, B, A, \Delta' \vdash C$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Delta, B, \Delta' \vdash C$}
        \DisplayProof
        &
        $\to_{\operatorname{cut}}$
        &
        \startproof{$\pi_1$}
        \RightLabel{$(r)$}
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Delta, A, B, \Delta' \vdash C$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Delta, B, \Delta' \vdash C$}
        \DisplayProof
        &
        \tagarray{\label{cut:any_vs_ex}}
    \end{tabular}
\end{center}
The remaining rules consist of the situations where the cut formula is introduced as a right introduction rule on the left branch and a left introduction rule on the right branch.
\item $\rimp$ on the left and $\limp$ on the right:
\begin{center}
\begin{tabular}{>{\centering}m{10cm} >{\centering}m{1cm}}
            \AxiomC{$\pi_1$}
            \noLine
            \UnaryInfC{$\vdots$}
            \noLine
            \UnaryInfC{$\Gamma, A, \Gamma' \vdash B$}
            \RightLabel{$\rimp$}
            \UnaryInfC{$\Gamma, \Gamma' \vdash A \multimap B$}
            \AxiomC{$\pi_2$}
            \noLine
            \UnaryInfC{$\vdots$}
            \noLine
            \UnaryInfC{$\Delta \vdash A$}
            \AxiomC{$\pi_3$}
            \noLine
            \UnaryInfC{$\vdots$}
            \noLine
            \UnaryInfC{$\Theta, B, \Theta' \vdash C$}
            \RightLabel{$\limp$}
            \BinaryInfC{$A \multimap B, \Delta, \Theta, \Theta' \vdash C$}
            \RightLabel{$({\operatorname{cut}})$}
            \BinaryInfC{$\Gamma, \Gamma', \Delta, \Theta, \Theta' \vdash C$}
            \DisplayProof\\\vspace{0.5cm}
            $\to_{\operatorname{cut}}$\\\vspace{0.5cm}
            \AxiomC{$\pi_2$}
            \noLine
            \UnaryInfC{$\vdots$}
            \noLine
            \UnaryInfC{$\Delta \vdash A$}
            \AxiomC{$\pi_1$}
            \noLine
            \UnaryInfC{$\vdots$}
            \noLine
            \UnaryInfC{$\Gamma, A, \Gamma' \vdash B$}
            \RightLabel{$({\operatorname{cut}})$}
            \BinaryInfC{$\Delta, \Gamma, \Gamma' \vdash B$}
            \AxiomC{$\pi_3$}
            \noLine
            \UnaryInfC{$\vdots$}
            \noLine
            \UnaryInfC{$\Theta, B, \Theta' \vdash C$}
            \RightLabel{$({\operatorname{cut}})$}
            \BinaryInfC{$\Delta, \Gamma, \Gamma', \Theta, \Theta' \vdash C$}
            \doubleLine
            \RightLabel{$({\operatorname{ex}})$}
            \UnaryInfC{$\Gamma, \Gamma', \Delta, \Theta, \Theta' \vdash C$}
            \DisplayProof
            &
        \tagarray{\label{cut:rimp_vs_limp}}
        \end{tabular}
        \end{center}
\item $\rtensor$ on the left branch and $\ltensor$ on the right branch:
\begin{center}
    \begin{tabular}{>{\centering}m{10cm} >{\centering}m{1cm}}
        \startproof{$\pi_2$}
        \UnaryInfC{$\Delta \vdash B$}
        \startproof{$\pi_1$}
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_3$}
        \UnaryInfC{$\Theta, A, B, \Theta' \vdash C$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Theta, B, \Theta' \vdash C$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Delta, \Gamma, \Theta, \Theta' \vdash C$}
        \RightLabel{$\ex$}
        \doubleLine
        \UnaryInfC{$\Gamma, \Delta, \Theta, \Theta' \vdash C$}
        \DisplayProof\\\vspace{0.5cm}
        $\to_{\operatorname{cut}}$\\\vspace{0.5cm}
        \startproof{$\pi_1$}
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \UnaryInfC{$\Delta \vdash B$}
        \RightLabel{$\rtensor$}
        \BinaryInfC{$\Gamma, \Delta \vdash A \otimes B$}
        \startproof{$\pi_3$}
        \UnaryInfC{$\Theta, A, B, \Theta' \vdash C$}
        \RightLabel{$\ltensor$}
        \UnaryInfC{$\Theta, A \otimes B, \Theta' \vdash C$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Delta, \Theta, \Theta' \vdash C$}
        \DisplayProof\\\vspace{0.5cm}
        $\to_{\operatorname{cut}}$\\\vspace{0.5cm}
        \startproof{$\pi_1$}
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \UnaryInfC{$\Delta \vdash B$}
        \startproof{$\pi_3$}
        \UnaryInfC{$\Theta, A, B, \Theta' \vdash C$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Delta, \Theta, A, \Theta' \vdash C$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Delta, \Theta, \Theta' \vdash C$}
        \DisplayProof
        &
        \tagarray{\label{cut:rtensor_ltensor}}
    \end{tabular}
\end{center}
\item $\rplusleft$ on the left and $\lplus$ on the right:
\begin{center}
    \begin{tabular}{>{\centering}m{10cm} >{\centering}m{1cm}}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \RightLabel{$\rplusleft$}
        \UnaryInfC{$\Gamma \vdash A \oplus B$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Delta, A, \Delta' \vdash C$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Delta, B, \Delta' \vdash C$}
        \RightLabel{$\lplus$}
        \BinaryInfC{$\Delta, A \oplus B, \Delta' \vdash C$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Delta, \Delta' \vdash C$}
        \DisplayProof\\\vspace{0.5cm}
        $\to_{\operatorname{cut}}$\\\vspace{0.5cm}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Delta, A, \Delta' \vdash C$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Delta, \Delta' \vdash C$}
        \DisplayProof
        &
        \tagarray{\label{cut:rplusleft_lplus}}
    \end{tabular}
\end{center}
\item $\rplusright$ on the left and $\lplus$ on the right:
\begin{center}
    \begin{tabular}{>{\centering}m{10cm} >{\centering}m{1cm}}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \RightLabel{$\rplusleft$}
        \UnaryInfC{$\Gamma \vdash B \oplus A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Delta, B, \Delta' \vdash C$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Delta, A, \Delta' \vdash C$}
        \RightLabel{$\lplus$}
        \BinaryInfC{$\Delta, B \oplus A, \Delta' \vdash C$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Delta, \Delta' \vdash C$}
        \DisplayProof\\\vspace{0.5cm}
        $\to_{\operatorname{cut}}$\\\vspace{0.5cm}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Delta, A, \Delta' \vdash C$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Delta, \Delta' \vdash C$}
        \DisplayProof
    &
    \tagarray{\label{cut:rplusright_lplus}}
    \end{tabular}
\end{center}
\item $\rwith$ on the left and $\lwithleft$ on the right:
\begin{center}
    \begin{tabular}{>{\centering}m{10cm} >{\centering}m{1cm}}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Gamma \vdash B$}
        \RightLabel{$\rwith$}
        \BinaryInfC{$\Gamma \vdash A \& B$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Delta, A, \Delta' \vdash C$}
        \RightLabel{$\lwithleft$}
        \UnaryInfC{$\Delta, A \& B, \Delta' \vdash C$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Delta, \Delta' \vdash C$}
        \DisplayProof\\\vspace{0.5cm}
        $\to_{\operatorname{cut}}$\\\vspace{0.5cm}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Delta, A, \Delta' \vdash C$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Delta, \Delta' \vdash C$}
        \DisplayProof
        &
    \tagarray{\label{cut:rwith_lwithleft}}
    \end{tabular}
\end{center}
\item $\rwith$ on the left and $\lwithright$ on the right:
\begin{center}
    \begin{tabular}{>{\centering}m{10cm} >{\centering}m{1cm}}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$\Gamma \vdash B$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \RightLabel{$\rwith$}
        \BinaryInfC{$\Gamma \vdash B \& A$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Delta, A, \Delta' \vdash C$}
        \RightLabel{$\lwithleft$}
        \UnaryInfC{$\Delta, B \& A, \Delta' \vdash C$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Delta, \Delta' \vdash C$}
        \DisplayProof\\\vspace{0.5cm}
        $\to_{\operatorname{cut}}$\\\vspace{0.5cm}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_3$}
        \noLine
        \UnaryInfC{$\Delta, A, \Delta' \vdash C$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Delta, \Delta' \vdash C$}
        \DisplayProof
        &
    \tagarray{\label{cut:rwith_lwithright}}
    \end{tabular}
\end{center}
\end{itemize}
\end{defn}
The following rules are $\cut$-reduction steps corresponding to when $\prom$ is the final rule in the proof on the left branch of the $\cut$.
\begin{defn}[$\prom$-cut reduction]\label{def:prom_equivalence}
We define $\to_{\prom}$ to be the smallest, compatible relation such that:
\begin{itemize}
    \item $\der$ on the right:
\begin{center}
    \begin{tabular}{>{\centering}m{8cm} >{\centering}m{0.5cm} >{\centering}m{7cm} >{\centering}m{0.5cm}}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$!\Gamma \vdash A$}
        \RightLabel{$\prom$}
        \UnaryInfC{$!\Gamma \vdash !A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Delta, A, \Delta' \vdash B$}
        \RightLabel{$\der$}
        \UnaryInfC{$\Delta, !A, \Delta' \vdash B$}
        \RightLabel{$\cut$}
        \BinaryInfC{$!\Gamma, \Delta, \Delta' \vdash B$}
        \DisplayProof
        &
        $\to_{\prom}$
        &
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$!\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$\Delta, A, \Delta' \vdash B$}
        \RightLabel{$\cut$}
        \BinaryInfC{$!\Gamma, \Delta, \Delta' \vdash B$}
        \DisplayProof
        &
        \tagarray{\label{cut:prom_der}}
    \end{tabular}
\end{center}
\item $\weak$ on the right:
\begin{center}
\begin{tabular}{>{\centering}m{8cm} >{\centering}m{0.5cm} >{\centering}m{6cm} >{\centering}m{0.5cm}}
        \AxiomC{$\pi_1$}
        \noLine
        \UnaryInfC{$\vdots$}
        \noLine
        \UnaryInfC{$!\Gamma \vdash A$}
        \RightLabel{$\prom$}
        \UnaryInfC{$!\Gamma \vdash !A$}
        \AxiomC{$\pi_2$}
        \noLine
        \UnaryInfC{$\vdots$}
        \noLine
        \UnaryInfC{$\Delta, \Delta' \vdash B$}
        \RightLabel{$({\operatorname{weak}})$}
        \UnaryInfC{$\Delta, !A, \Delta' \vdash B$}
        \RightLabel{$({\operatorname{cut}})$}
        \BinaryInfC{$!\Gamma, \Delta, \Delta' \vdash B$}
        \DisplayProof
        & $\to_{\prom}$ &
        \AxiomC{$\pi_2$}
        \noLine
        \UnaryInfC{$\vdots$}
        \noLine
        \UnaryInfC{$\Delta, \Delta' \vdash B$}
        \RightLabel{$({\operatorname{weak}})$}
        \doubleLine
        \UnaryInfC{$!\Gamma, \Delta, \Delta' \vdash B$}
        \DisplayProof
        &
        \tagarray{\label{cut:prom_vs_weak}}
\end{tabular}
\end{center}
\item $\ctr$ on the right:
\begin{center}
\begin{tabular}{>{\centering}m{13cm} >{\centering}m{1cm}}
        \AxiomC{$\pi_1$}
        \noLine
        \UnaryInfC{$\vdots$}
        \noLine
        \UnaryInfC{$!\Gamma \vdash A$}
        \RightLabel{$\prom$}
        \UnaryInfC{$!\Gamma \vdash !A$}
        \AxiomC{$\pi_2$}
        \noLine
        \UnaryInfC{$\vdots$}
        \noLine
        \UnaryInfC{$\Delta, !A, !A, \Delta' \vdash B$}
        \RightLabel{$({\operatorname{ctr}})$}
        \UnaryInfC{$\Delta, !A, \Delta' \vdash B$}
        \RightLabel{$({\operatorname{cut}})$}
        \BinaryInfC{$!\Gamma, \Delta, \Delta' \vdash B$}
        \DisplayProof\\\vspace{0.5cm}
         $\to_{\prom}$\\\vspace{0.5cm}
        \AxiomC{$\pi_1$}
        \noLine
        \UnaryInfC{$\vdots$}
        \noLine
        \UnaryInfC{$!\Gamma \vdash A$}
        \RightLabel{$\prom$}
        \UnaryInfC{$!\Gamma \vdash !A$}
        \AxiomC{$\pi_1$}
        \noLine
        \UnaryInfC{$\vdots$}
        \noLine
        \UnaryInfC{$!\Gamma \vdash A$}
        \RightLabel{$\prom$}
        \UnaryInfC{$!\Gamma \vdash !A$}
        \AxiomC{$\pi_2$}
        \noLine
        \UnaryInfC{$\vdots$}
        \noLine
        \UnaryInfC{$\Delta, !A,!A, \Delta' \vdash B$}
        \RightLabel{$({\operatorname{cut}})$}
        \BinaryInfC{$\Gamma, \Delta,!A, \Delta' \vdash B$}
        \RightLabel{$({\operatorname{cut}})$}
        \BinaryInfC{$!\Gamma, \Gamma, \Delta, \Delta' \vdash B$}
        \RightLabel{$({\operatorname{ctr/ex}})$}
        \doubleLine
        \UnaryInfC{$!\Gamma, \Delta, \Delta' \vdash B$}
        \DisplayProof
        & 
        \tagarray{\label{cut:prom_vs_ctr}}
\end{tabular}
\end{center}
\item $\prom$ on the right:
\begin{center}
    \begin{tabular}{>{\centering}m{8cm} >{\centering}m{1.0cm} >{\centering}m{8cm} >{\centering}m{0.5cm}}
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$!\Gamma \vdash A$}
        \RightLabel{$\prom$}
        \UnaryInfC{$!\Gamma \vdash !A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$!\Delta, !A, !\Delta' \vdash B$}
        \RightLabel{$\prom$}
        \UnaryInfC{$!\Delta, !A, !\Delta' \vdash !B$}
        \RightLabel{$\cut$}
        \BinaryInfC{$!\Gamma, !\Delta, !\Delta' \vdash !B$}
        \DisplayProof
        &
        $\to_{\prom}$
        &
        \startproof{$\pi_1$}
        \noLine
        \UnaryInfC{$!\Gamma \vdash A$}
        \RightLabel{$\prom$}
        \UnaryInfC{$!\Gamma \vdash !A$}
        \startproof{$\pi_2$}
        \noLine
        \UnaryInfC{$!\Delta, !A, !\Delta' \vdash B$}
        \RightLabel{$\cut$}
        \BinaryInfC{$!\Gamma, !\Delta, !\Delta' \vdash B$}
        \RightLabel{$\prom$}
        \UnaryInfC{$!\Gamma, !\Delta, !\Delta' \vdash !B$}
        \DisplayProof
        &
        \tagarray{\label{cut:prom_vs_prom}}
    \end{tabular}
\end{center}
\end{itemize}
\end{defn}
%
%
%
%
%
%
We can now define when two proofs are equivalent:
\begin{defn}\label{def:proof_equivalence}
We define $\sim_p$ to be the smallest, compatible equivalence relation containing the union of:
\begin{itemize}
    \item $\tau$-equivalence, Definition \ref{def:tau-equivalence},
    \item commuting equivalence, Definition \ref{def:commuting_equiv},
    \item with equivalence, Definition \ref{def:with_equivalence},
    \item single step cut reduction, Definition \ref{def:cut_reduction},
    \item promotion equivalence, Definition \ref{def:prom_equivalence}.
\end{itemize}
A \textbf{proof} is an equivalence class of preproofs. We let $\scr{P}$ denote the set of proofs.
\end{defn}
\section{Cut-elimination}
Naively, one might seek computational content inside a system of logic by analysing the flow of data through a fixed proof as one reads it from top to bottom. This is \emph{not} the correct intuition behind the computational content of intuitionistic linear logic to be described in this Section. Instead, one computes a proof $\pi_1$ of $\Gamma, A, \Gamma' \vdash B$ on input a proof $\pi_2$ of $\Delta \vdash A$ by constructing the proof:
\begin{prooftree}
\startproof{$\pi_2$}
\noLine
\UnaryInfC{$\Delta \vdash A$}
\startproof{$\pi_2$}
\noLine
\UnaryInfC{$\Gamma, A, \Gamma' \vdash B$}
\RightLabel{$\cut$}
\BinaryInfC{$\Delta, \Gamma, \Gamma' \vdash B$}
\end{prooftree}
which we denote $\pi_2 \mid \pi_1$, the result of the computation is then a cut-free proof equivalent to $\pi_2 \mid \pi_1$, the existence of which is enforced by Theorem \ref{Thm:cut_reduction} (below).
\begin{defn}
The \textbf{complexity} of a formula $A$, denoted $c(A)$, is the sum of all occurrences of $\multimap, \oplus, \otimes, \&, !$ inside $A$.
\end{defn}
\begin{defn}
The \textbf{height} of a proof $\pi$, denoted $h(\pi)$, is one less than the number of deduction rules encountered on the longest path in the underlying tree of the proof.
\end{defn}
A proof consisting of only an axiom rule has height zero, a proof which does not contain an occurrence of the $\cut$ rule is \textbf{cut-free}.
\begin{example}
For $p,q,r$ atomic, the formula $!p \multimap (q \otimes !r)$ has complexity $4$.
\end{example}
\begin{thm}\label{Thm:cut_reduction}
Any proof $\pi$ of the form
\begin{center}
    \begin{tabular}{>{\centering}m{9cm} >{\centering}m{1cm}}
        \begin{prooftree}
        \startproof{$\pi_1$}
        \RightLabel{$(r_1)$}
        \UnaryInfC{$\Gamma \vdash A$}
        \startproof{$\pi_2$}
        \RightLabel{$(r_2)$}
        \UnaryInfC{$\Delta, A, \Delta' \vdash B$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma, \Delta, \Delta' \vdash B$}
        \end{prooftree}
        &
        \tagarray{\label{proof:standard_form}}
    \end{tabular}
\end{center}
\end{thm}
where $\pi_1$ and $\pi_2$ are both cut-free, is equivalent under $\sim_p$ to a cut-free proof.
\begin{proof}
Let $P(c,n)$ denote the following statement: any proof $\pi$ with cut-free branches $\pi_1,\pi_2$ and final cut formula $A$ (as above) satisfying $c(A) + c(B) = c$ and $n = h(\pi_1) + h(\pi_2)$ is equivalent under $\sim_p$ to a cut-free proof. Let $P(c)$ denote $\forall n, P(c,n)$. We will prove $\forall c, P(c)$ by induction on $c$. Thus we must show $P(0)$ and that if for all $d < c, P(d)$ then $P(c)$. We refer to this as the \textbf{outer induction}.

\textbf{Base case of the outer induction:} to prove $P(0)$ (that is, $\forall n P(0,n)$) we proceed by induction on $n$, which we refer to as the \textbf{inner induction}. In the base case $P(0,0)$ of the inner induction, the rules $(r_1),(r_2)$ are each taken from the set
\begin{equation}
    \scr{X}_0 := \lbrace \ax, \rone, \rtrue\rbrace
\end{equation}
The $\cut$ rule requires the antecedent of the final sequent on the right branch to be non-empty, so $(r_2) \neq \rone$. The cases $(r_1) = (r_2) = \rtrue$ and $\big((r_2),(r_2)\big) = \big(\rone, \rtrue\big)$ are taken care of by \eqref{cut:any_true}. In the remaining cases, at least one of $(r_1),(r_2)$ are $\ax$ and these is covered by \eqref{cut:ax_left}, \eqref{cut:ax_right}.

Now say $n > 0$ and assume $P(0,k)$ holds for all $k < n$. If $(r_1)$ is $\ax$ then the result follows from \eqref{cut:ax_left}. If $(r_1)$ is $\rone$ or $\rtrue$ then $(r_2)$ is either $\ax$ or $\rtrue$ and so we have reduced to the base case. If $(r_1)$ is a unary, logical rule then since $c = 0$, $(r_1)$ must be a left rule, ie,
\begin{equation}
    (r_1) \in \lbrace \lone, \ltensor, \lwithleft, \lwithright\rbrace
\end{equation}
and so the result follows by applying the inductive hypothesis and \eqref{cut:struc_or_unary_left_log_vs_any}. Similarly, if $(r_1)$ is a binary logical rule, which since $c = 0$ implies $(r_1) = \lplus$ or $\limp$, we apply the inductive hypothesis and \eqref{cut:bin_left_log_vs_any}.

Since $c = 0$ we have $(r_1) \neq \prom$.

If $(r_1)$ is a structural rule then apply the inductive hypothesis and \eqref{cut:struc_or_unary_left_log_vs_any}.

\textbf{Inductive step of the outer induction}: now suppose that $c > 0$ is fixed and $P(d)$ holds for all $d < c$. To prove $P(c)$ (that is, $\forall n P(c,n)$) we proceed by induction on $n$, which we again refer to as the inner induction. If $n \leq 1$ then one of $(r_1),(r_2)$ is $\ax$ so the claim follows from \eqref{cut:ax_left}, \eqref{cut:ax_right}. Suppose now that $n > 1$ and that $P(c,k)$ holds for all $k  < n$. We again divide into cases depending on the final deduction rules $(r_1),(r_2)$. Some cases follow from the inner inductive hypothesis as in the proof of the base case of the outer induction above, and we will not repeat them. The new cases that are easily dispensed with:
\begin{itemize}
    \item If $(r_2)$ is any right, logical rule other than $\rwith$ then the result follows from \eqref{cut:any_unary_rlog}, \eqref{cut:any_vs_bin_right_log_one}, \eqref{cut:any_vs_bin_right_log_two} and the inductive hypothesis.
    \item Say $(r_1)$ is a non zero-ary right logical rule, ie, 
    \begin{equation}
        (r_1) \in \lbrace \rtensor, \rplusleft, \rplusright, \rwith, \rimp \rbrace
    \end{equation}
    and $(r_2)$ is any left logical rule where the formula introduced by $(r_2)$ is not the cut formula. The result follows from \eqref{cut:log_or_prom_vs_unary_left_log_or_struct_not_manip}, \eqref{cut:log_vs_bin_left_log_one}, \eqref{cut:log_vs_bin_left_log_two}.
    \item $\big((r_1),(r_2)\big) = \big(\rtensor, \ltensor\big)$ where $\ltensor$ introduces the cut formula. Then, where $A' \otimes B' = A$, $\Gamma_1,\Gamma_2 = \Gamma$, and $\Theta, \Theta' = \Delta, \Delta'$, the proof $\pi$ is by \eqref{cut:rtensor_ltensor} equivalent either to
    \begin{prooftree}
        \startproof{$\pi_1'$}
        \UnaryInfC{$\Gamma_1 \vdash A'$}
        \startproof{$\pi_2'$}
        \UnaryInfC{$\Gamma_2 \vdash B'$}
        \startproof{$\pi_3'$}
        \UnaryInfC{$\Theta, A', B', \Theta' \vdash C$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma_2, \Theta, A', \Theta' \vdash C$}
        \RightLabel{$\cut$}
        \BinaryInfC{$\Gamma_1, \Gamma_2, \Theta, \Theta' \vdash C$}
    \end{prooftree}
    where both cuts are of lower complexity than the one in $\pi$. The result thus follows from the outer inductive hypothesis.
    \item The cases
    \begin{align*}
        \big((r_1),(r_2)\big) = &\big\lbrace\big(\rimp, \limp\big), \big(\rwith, \lwithleft\big),\big(\rwith, \lwithright\big),\\
        &\big(\rplusleft, \lplus\big), \big(\rplusright, \lplus\big), \big(\prom, \der\big)
    \end{align*}
    are all similar to the previous case; they follow from the outer inductive hypothesis and \eqref{cut:rimp_vs_limp}, \eqref{cut:rwith_lwithleft}, \eqref{cut:rwith_lwithright}, \eqref{cut:rplusleft_lplus}, \eqref{cut:rplusright_lplus}, \eqref{cut:prom_der} respectively.
    \item if $(r_2) = \ex$ the result follows from the inner inductive hypothesis and \eqref{cut:any_vs_ex}.
    \item Say $(r_2)$ is $\weak$, then if $(r_1) \neq \prom$, it follows that $(r_1)$ cannot be a right logical rule (otherwise we would contradict the structure of the cut formula), and so $(r_1)$ can be brought beneath the $\cut$ by \eqref{cut:struc_or_unary_left_log_vs_any}, \eqref{cut:bin_left_log_vs_any} and the result follows from the inner inductive hypothesis. If $(r_1) = \prom$ and the cut-formula is not manipulated by $(r_2)$ then the result follows from \eqref{cut:log_or_prom_vs_unary_left_log_or_struct_not_manip} and the inductive hypothesis. If $(r_1) = \prom$ and the cut-formula \emph{is} introduced by $(r_2) = \weak$, then the result follows from \eqref{cut:prom_vs_weak}.
    \item If $(r_2) = \ctr$ and the contraction is not against the cut formula, then the result follows from the inner inductive hypothesis and \eqref{cut:log_or_prom_vs_unary_left_log_or_struct_not_manip}.
    \item If $(r_2) = \prom$ then $(r_1)$ cannot be a right logical rule, as this will contradict the structure of the cut formula. So to avoid reducing to a case already considered, we must have $(r_1) = \prom$. The result then follows from \eqref{cut:prom_vs_prom} and the inductive hypothesis.
\end{itemize}
The remaining cases are when $(r_1)$ is a right logical rule or $\prom$, and $(r_2)$ is an active contraction or $\rwith$. Say $(r_2)$ is an active contraction, then the $\cut$-formula must be of the form $!A'$ for some formula $A'$ and so $(r_1)$ cannot be logical, that is, $(r_1) = \prom$ and result now follows from Lemma \ref{lem:right_logical_or_prom_vs_active_ctr_or_rwith}.

We have now reduced to the final case, where $(r_1)$ is a logical right rule and $(r_2) = \rwith$. We apply \eqref{cut:any_rwith} and use the outer inductive hypothesis twice.
\end{proof}
%
%
%
\begin{defn}\label{def:strong_ancestor}
Let $A$ be a formula and $A_1,A_2$ be labelled occurrences of the formula $A$, that is $A_1 = A_2 = A$. Then $A_1$ is an \textbf{immediate strong ancestor} of $A_2$ in a proof $\pi$ if the pair $(A_1,A_2)$ appear in $\pi$ in any of the following ways:
\begin{center}
    \begin{tabular}{ >{\centering}m{9cm} >{\centering}m{9cm}}
        \begin{prooftree}
        \AxiomC{$\Gamma, A_1, \Gamma', \Gamma'' \vdash B$}
        \RightLabel{$\lone$}
        \UnaryInfC{$\Gamma, A_2, \Gamma', \bold{1}, \Gamma'' \vdash B$}
        \end{prooftree}
        &
        \begin{prooftree}
        \AxiomC{$\Gamma, A_1, \Gamma', B, C, \Gamma'' \vdash D$}
        \RightLabel{$\ltensor$}
        \UnaryInfC{$\Gamma, A_2, \Gamma', B \otimes C, \Gamma'' \vdash D$}
        \end{prooftree}
    \end{tabular}
    \begin{tabular}{ >{\centering}m{8cm} >{\centering}m{8cm}}
        \begin{prooftree}
        \AxiomC{$\Gamma, A_1, \Gamma' \vdash B$}
        \AxiomC{$\Delta \vdash C$}
        \RightLabel{$\rtensor$}
        \BinaryInfC{$\Gamma, A_2, \Gamma', \Delta \vdash B \otimes C$}
        \end{prooftree}
        &
        \begin{prooftree}
        \AxiomC{$\Gamma \vdash B$}
        \AxiomC{$\Delta, A_1, \Delta' \vdash C$}
        \RightLabel{$\rtensor$}
        \BinaryInfC{$\Gamma, \Delta, A_2, \Delta' \vdash C$}
        \end{prooftree}
        \end{tabular}
    \begin{tabular}{ >{\centering}m{8cm} >{\centering}m{8cm}}
        \begin{prooftree}
        \AxiomC{$\Gamma, A_1, \Gamma' \vdash B$}
        \RightLabel{$\rplusleft$}
        \UnaryInfC{$\Gamma, A_2, \Gamma' \vdash B \oplus C$}
        \end{prooftree}
        &
        \begin{prooftree}
        \AxiomC{$\Gamma, A_1, \Gamma' \vdash B$}
        \RightLabel{$\rplusright$}
        \UnaryInfC{$\Gamma, A_2, \Gamma' \vdash C \oplus B$}
        \end{prooftree}
        \end{tabular}
    \begin{tabular}{ >{\centering}m{8cm} >{\centering}m{8cm}}
        In the following rule, $A_3$ is another labelled occurrence of the formula $A$ (ie, $A_3 = A$) and both $A_1$ and $A_3$ are immediate strong ancestors of $A_2$:
        \begin{prooftree}
        \AxiomC{$\Gamma, A_1, \Gamma', B, \Gamma'' \vdash C$}
        \AxiomC{$\Gamma, A_3, \Gamma', D, \Gamma'' \vdash C$}
        \RightLabel{$\lplus$}
        \BinaryInfC{$\Gamma, A_2, \Gamma', B \oplus D, \Gamma'' \vdash C$}
        \end{prooftree}
        &
        In the following rule, $A_3$ is another labelled occurrence of the formula $A$ (ie, $A_3 = A$) and both $A_1$ and $A_3$ are immediate strong ancestors of $A_2$:
        \begin{prooftree}
        \AxiomC{$\Gamma, A_1, \Gamma' \vdash B$}
        \AxiomC{$\Gamma, A_3, \Gamma' \vdash C$}
        \RightLabel{$\rwith$}
        \BinaryInfC{$\Gamma, A_2, \Gamma' \vdash B \& C$}
        \end{prooftree}
        \end{tabular}
    \begin{tabular}{ >{\centering}m{8cm} >{\centering}m{8cm}}
        \begin{prooftree}
        \AxiomC{$\Gamma, A_1, \Gamma', B, \Gamma'' \vdash C$}
        \RightLabel{$\lwithleft$}
        \UnaryInfC{$\Gamma, A_1, \Gamma', B \& D, \Gamma'' \vdash C$}
        \end{prooftree}
        &
        \begin{prooftree}
        \AxiomC{$\Gamma, A_1, \Gamma', B, \Gamma'' \vdash C$}
        \RightLabel{$\lwithright$}
        \UnaryInfC{$\Gamma, A_1, \Gamma', D \& B, \Gamma'' \vdash C$}
        \end{prooftree}
        \end{tabular}
    \begin{tabular}{ >{\centering}m{8cm} >{\centering}m{8cm}}
        \begin{prooftree}
        \AxiomC{$\Gamma, A_1, \Gamma', B, \Gamma'' \vdash C$}
        \RightLabel{$\rimp$}
        \UnaryInfC{$\Gamma, A_2, \Gamma', \Gamma'' \vdash B \multimap C$}
        \end{prooftree}
        &
        \begin{prooftree}
        \AxiomC{$\Gamma, A_1, \Gamma' \vdash B$}
        \AxiomC{$\Delta, C, \Delta' \vdash D$}
        \RightLabel{$\limp$}
        \BinaryInfC{$B \multimap C, \Gamma, A_2, \Gamma', \Delta, \Delta' \vdash D$}
        \end{prooftree}
        \end{tabular}
    \begin{tabular}{ >{\centering}m{8cm} >{\centering}m{8cm}}
        \begin{prooftree}
        \AxiomC{$\Gamma \vdash B$}
        \AxiomC{$\Delta, A_1, \Delta', C, \Delta'' \vdash D$}
        \RightLabel{$\limp$}
        \BinaryInfC{$B \multimap C, \Gamma, \Delta, A_2, \Delta', \Delta'' \vdash D$}
        \end{prooftree}
        &
        \begin{prooftree}
        \AxiomC{$!\Gamma, A_1, !\Gamma' \vdash B$}
        \RightLabel{$\prom$}
        \UnaryInfC{$!\Gamma, A_2, !\Gamma' \vdash !B$}
        \end{prooftree}
        \end{tabular}
    \begin{tabular}{ >{\centering}m{8cm} >{\centering}m{8cm}}
        \begin{prooftree}
        \AxiomC{$\Gamma, A_1, \Gamma', B, \Gamma'' \vdash C$}
        \RightLabel{$\der$}
        \UnaryInfC{$\Gamma, A_2, \Gamma', !B, \Gamma'' \vdash C$}
        \end{prooftree}
        &
        \begin{prooftree}
        \AxiomC{$\Gamma, A_1, \Gamma', B, C, \Gamma'' \vdash D$}
        \RightLabel{$\ex$}
        \UnaryInfC{$\Gamma, A_2, \Gamma', C, B, \Gamma'' \vdash D$}
        \end{prooftree}
        \end{tabular}
    \begin{tabular}{ >{\centering}m{8cm} >{\centering}m{8cm}}
        \begin{prooftree}
        \AxiomC{$\Gamma, A_1, B, \Gamma' \vdash C$}
        \RightLabel{$\ex$}
        \UnaryInfC{$\Gamma, B, A_2, \Gamma' \vdash C$}
        \end{prooftree}
        &
        \begin{prooftree}
        \AxiomC{$\Gamma, A_1, \Gamma', !B, !B, \Gamma'' \vdash C$}
        \RightLabel{$\ctr$}
        \UnaryInfC{$\Gamma, A_2, \Gamma', !B, \Gamma'' \vdash C$}
        \end{prooftree}
        \end{tabular}
    \begin{tabular}{ >{\centering}m{8cm} >{\centering}m{8cm}}
        \begin{prooftree}
        \AxiomC{$\Gamma, A_1, A, \Gamma' \vdash B$}
        \RightLabel{$\ctr$}
        \UnaryInfC{$\Gamma, A_2, \Gamma' \vdash B$}
        \end{prooftree}
        &
        \begin{prooftree}
        \AxiomC{$\Gamma, A_1, \Gamma', \Gamma'' \vdash B$}
        \RightLabel{$\weak$}
        \UnaryInfC{$\Gamma, A_1, \Gamma', !C, \Gamma'' \vdash B$}
        \end{prooftree}
    \end{tabular}
\end{center}
Furthermore, $A_1$ is a \textbf{immediate weak ancestor} of $A_2$ if it is either an immediate strong ancestor, or it is either formula involved in a contraction. Any pair of formulas connected by a chain of immediate strong (weak) ancestors is a \textbf{strong (weak) ancestor}. An \textbf{active contraction} with respect to a formula occurrence $A$ is an occurrence of a $\ctr$ rule where the formulas involved in the contraction are weak ancestors of $A$.
\end{defn}
\begin{remark}
In Definition \ref{def:strong_ancestor}, we only described \emph{left handed} rules, but the right handed version is also assumed. For instance, we wrote
\begin{prooftree}
        \AxiomC{$\Gamma, A_1, \Gamma', \Gamma'' \vdash B$}
        \RightLabel{$\lone$}
        \UnaryInfC{$\Gamma, A_2, \Gamma', \bold{1}, \Gamma'' \vdash B$}
\end{prooftree}
but we also include
\begin{prooftree}
        \AxiomC{$\Gamma, \Gamma',  A_1, \Gamma'' \vdash B$}
        \RightLabel{$\lone$}
        \UnaryInfC{$\Gamma, \bold{1}, \Gamma', A_2, \Gamma'' \vdash B$}
\end{prooftree}
\end{remark}
\begin{remark}
In the following proof segment, the greater height $\ctr$ is \emph{not} active with respect to $!(A \oplus B)$ occurring in the hypotheses of the final sequent.
\begin{prooftree}
\AxiomC{$!(A \oplus B), !(A \oplus B), A \vdash C$}
\RightLabel{$\ctr$}
\UnaryInfC{$!(A \oplus B), A \vdash C$}
\AxiomC{$!(A \oplus B), B \vdash C$}
\RightLabel{$\lplus$}
\BinaryInfC{$!(A \oplus B), A \oplus B \vdash C$}
\RightLabel{$\der$}
\UnaryInfC{$!(A \oplus B), !(A \oplus B) \vdash C$}
\RightLabel{$\ctr$}
\UnaryInfC{$!(A \oplus B) \vdash C$}
\end{prooftree}
This reflects how in \cite{GMZ}, a contraction which happens above a $(\operatorname{L} \supset)$ rule is never active. The important point here is that there exist $\ctr$ rules which cannot be commuted below $\lplus$ rules, but such rules are never active!
\end{remark}
\begin{lemma}\label{lem:base_case_contraction_normal_form}
Say $\pi$ is a $\cut$-free proof of $\Gamma \vdash A$ where $A$ cannot be written as $A_1 \& A_2$ for any formulas $A_1,A_2$, and say $!B \in \Gamma$ is such that the contraction tree of $(\pi, !B)$ contains no edges labelled $\lplus$. Then $\pi$ is equivalent to a proof of the form
\begin{prooftree}
\startproof{$\pi'$}
\noLine
\UnaryInfC{$\Gamma, !B,...,!B, \Gamma' \vdash C$}
\doubleLine
\RightLabel{$\ctr$}
\UnaryInfC{$\Gamma, !B, \Gamma' \vdash C$}
\end{prooftree}
where $\pi'$ contains no active contractions with respect to any of the formulas $!B$ visible in the displayed conclusion of $\pi'$.
\end{lemma}
\begin{proof}
Consider a slack vertex $!B$ in the contraction tree of $(\pi,!B)$, the incoming edge $(r)$ cannot be $\rwith$ nor $\lplus$ by assumption, and so using \eqref{com:unary_unary_left_right} if $(r) = \rimp, \rplusleft, \rplusright, \prom$, using \eqref{com:unary_unary_left_left} if $(r) = \lwithleft, \lwithright, \ltensor, \der$ \footnote{Notice that if $(r)$ is any of $\lwithleft, \lwithright, \ltensor, \der$, then the formula manipulated by $(r)$ cannot be $!B$ (the formula corresponding to the slack formula in question) by definition of an active contraction.}, using \eqref{com:unary_binary_left_right} if $(r) = \rtensor$ and using \eqref{com:unary_unary_left_left} if $(r) = \limp$ (which exhausts all possibilities) this contraction can be brought beneath $(r)$. The proof then follows by induction on the sum of heights of the active contractions, as was done in \cite[\S 2.1, Lemma 2.36]{GMZ}.
\end{proof}
\begin{lemma}\label{lem:introduced_by_ax_or_rtrue}
Suppose given a proof $\pi$ of the form
\begin{prooftree}
\startproof{$\pi_1$}
\noLine
\UnaryInfC{$!\Gamma \vdash A$}
\RightLabel{$\prom$}
\UnaryInfC{$!\Gamma \vdash !A$}
\startproof{$\pi_2$}
\RightLabel{$(r)$}
\UnaryInfC{$\Delta, !A, \Delta' \vdash B$}
\RightLabel{$\cut$}
\BinaryInfC{$!\Gamma, \Delta, \Delta' \vdash B$}
\end{prooftree}
where the cut formula $!A$ is introduced by either $\ax$ or $\rtrue$, and there is no active contraction inside $\pi_2$ with respect to the displayed occurrence of $!A$. Then $\pi$ is equivalent to a $\cut$-free proof.
\end{lemma}
\begin{proof}
The proof is essentially the observation that $(r)$ can always be brought beneath the $\cut$. By induction on the height of $\pi_2$. The base case follows from \eqref{cut:ax_right} or \eqref{cut:any_true}. For the inductive step where $\pi_2$ has height $> 0$ we break into cases depending on the rule $(r)$:
\begin{itemize}
    \item $(r)$ is a structural rule. Since $!A$ is introduced by either $\ax$ or $\rtrue$, it is in particular \emph{not} introduced by $\der$. Also, there are no active contractions in $\pi_2$ so the cut formula is not manipulated by $(r)$ and so this case follows from the inductive hypothesis and \eqref{cut:log_or_prom_vs_unary_left_log_or_struct_not_manip}.
    \item If $(r)$ is a unary, left, logical rule, by \eqref{cut:log_or_prom_vs_unary_left_log_or_struct_not_manip} and the inductive hypothesis.
    \item If $(r)$ is a proper, binary, left, logical rule, by \eqref{cut:log_vs_bin_left_log_one} or \eqref{cut:log_vs_bin_left_log_two} and the inductive hypothesis.
    \item If $(r)$ is a unary, right, logical rule, by \eqref{cut:any_unary_rlog} and the inductive hypothesis.
    \item If $(r)$ is a proper, binary, right, logical rule, by \eqref{cut:any_vs_bin_right_log_one} or \eqref{cut:any_vs_bin_right_log_two} and the inductive hypothesis.
    \item If $(r) = \rwith$, by \eqref{cut:any_rwith} and the inductive hypothesis applied twice.
    \item If $(r) = \lplus$, by \eqref{cut:irrelevant_lplus} and the inductive hypothesis applied twice.
\end{itemize}
This exhausts all cases and so the proof is done.
\end{proof}
%
\begin{lemma}\label{lem:rwith_lplus_ctr_tree_base_case}
If $\pi$ is of the following form
\begin{prooftree}
\startproof{$\pi_1$}
\noLine
\UnaryInfC{$!\Gamma \vdash A$}
\RightLabel{$\prom$}
\UnaryInfC{$!\Gamma \vdash !A$}
\startproof{$\pi_2$}
\noLine
\UnaryInfC{$\Delta, !A, \Delta' \vdash B$}
\RightLabel{$\cut$}
\BinaryInfC{$!\Gamma, \Delta, \Delta' \vdash B$}
\end{prooftree}
where the proofs $\pi_1,\pi_2$ are $\cut$-free, and the contraction tree of $(\pi_2,!A)$ does not contain any edges labelled $\lplus$ and no edges labelled $\rwith$. Then $\pi$ is equivalent to a $\cut$-free proof.
\end{lemma}
\begin{proof}
By induction on the complexity $c(!A)$ of $!A$. The base case and the inductive step both begin in the same way, so assume $c(!A) = n$ for any $n \geq 1$.

By Lemma \ref{lem:base_case_contraction_normal_form}, $\pi$ is equivalent to a proof of the form
\begin{prooftree}
\startproof{$\pi_1$}
\noLine
\UnaryInfC{$!\Gamma \vdash A$}
\RightLabel{$\prom$}
\UnaryInfC{$!\Gamma \vdash !A$}
\startproof{$\pi_2'$}
\noLine
\UnaryInfC{$\Delta, (!A)_1, \hdots, (!A)_n, \Delta' \vdash B$}
\doubleLine
\RightLabel{$\ctr$}
\UnaryInfC{$\Delta, (!A)_1, \Delta' \vdash B$}
\RightLabel{$\cut$}
\BinaryInfC{$!\Gamma, \Delta, \Delta' \vdash B$}
\end{prooftree}
where we have introduced labels $(!A)_i$ for clarity. By \eqref{cut:prom_vs_ctr} this is equivalent to
\begin{prooftree}
\startproof{$\pi_1$}
\noLine
\UnaryInfC{$!\Gamma \vdash A$}
\RightLabel{$\prom$}
\UnaryInfC{$!\Gamma \vdash !A$}
\startproof{$\pi_1$}
\noLine
\UnaryInfC{$!\Gamma \vdash A$}
\RightLabel{$\prom$}
\UnaryInfC{$!\Gamma \vdash !A$}
\startproof{$\pi_1$}
\noLine
\UnaryInfC{$!\Gamma \vdash A$}
\RightLabel{$\prom$}
\UnaryInfC{$!\Gamma \vdash !A$}
\startproof{$\pi_2'$}
\noLine
\UnaryInfC{$\Delta, (!A)_1,...,(!A)_n, \Delta' \vdash B$}
\RightLabel{$\cut$}
\BinaryInfC{$!\Gamma, \Delta, (!A)_1,...,(!A)_{n-1}, \Delta' \vdash B$}
\noLine
\UnaryInfC{$\vdots$}
\noLine
\UnaryInfC{$(n-2)!\Gamma, \Delta, (!A)_1,(!A)_2, \Delta' \vdash B$}
\RightLabel{$\cut$}
\BinaryInfC{$(n-1)!\Gamma, \Delta, (!A)_1, \Delta' \vdash B$}
\RightLabel{$\cut$}
\BinaryInfC{$n!\Gamma, \Delta, \Delta' \vdash B$}
\doubleLine
\RightLabel{$\ctr$}
\UnaryInfC{$!\Gamma, \Delta, \Delta' \vdash B$}
\end{prooftree}
where $r!\Gamma$ denotes the concatenation of $r$ copies of the sequence $!\Gamma$. Note that this proof contains no active contractions for the final cut formula $(!A)_1 = !A$.

The formula $(!A)_i$ is introduced by a deduction rule $(r_i)$ which is either $\ax, \rtrue, \der, \weak$. Using \eqref{co:commutative} if necessary, we may assume there exists an integer $1 \leq m \leq n$ such that for all $1 \leq i \leq m$ the formula $(!A)_i$ is introduced by $\der$ or $\weak$, and for $i > m$ the formula $(!A)_i$ is introduced by either $\ax$ or $\rtrue$.

Since $\pi_2'$ contains no active contractions with respect to the final cut formula $(!A)$ we can, for each $1 \leq i \leq m$, use \eqref{com:unary_unary_left_left} to commute $(r_i)$ down inside $\pi_2'$ and either \eqref{cut:prom_der} or \eqref{cut:prom_vs_weak} to bring $(r_i)$ beneath each $\cut$ down to the one that is actually against the formula $(!A)_i$ introduced by $(r_i)$.

The top most $\cut$ is eliminated using Lemma \ref{lem:introduced_by_ax_or_rtrue}, working down the tree, the cuts against each $(!A)_i$ for $i > m$ is eliminated also by Lemma \ref{lem:introduced_by_ax_or_rtrue}.

The remaining cuts are eliminated one by one working down the tree by \eqref{cut:prom_der}, and by appealing to the inductive hypothesis in the case $n > 1$, and if $n = 1$ using the statement $P(0)$ already proved in Theorem \ref{Thm:cut_reduction}.
\end{proof}
\begin{lemma}\label{lem:right_logical_or_prom_vs_active_ctr_or_rwith}
The same statement as Lemma \ref{lem:rwith_lplus_ctr_tree_base_case} but we drop the assumption that there are no edges labelled $\rwith$ and no edges labelled $\lplus$ in the contraction tree of $(\pi, !A)$. Further we assume there exist formulas $A_1,A_2$ such that $A = A_1 \& A_2$.
\end{lemma}
\begin{proof}
By induction on the integer $n$ given by the sum of the number of edges labelled $\rwith$ and the number of edges labelled $\lplus$ in the contraction tree. The base case $n = 0$ is Lemma \ref{lem:rwith_lplus_ctr_tree_base_case}. We now assume $n > 0$ and that the result holds for all $k < n$.

Say there exists an occurrence of $\lplus$ in the contraction tree of height $h$ for which there exists no occurrence of $\rwith$ of height $\leq h$. Then using \eqref{with:lplus_left_unary_non_manip}, \eqref{with:lplus_right_unary_non_manip}, \eqref{with:lplus_limp}, \eqref{with:lplus_on_left_rtensor}, \eqref{with:lplus_on_right_rtensor} the occurrence of $\lplus$ in $\pi$ corresponding to this chosen occurrence in the contraction tree can be commuted down to obtain the following proof equivalent to $\pi$. Since $!A$ cannot be written in the form $B_1 \oplus B_2$ for any formulas $B_1,B_2$ it must be that $!A$ is not created by the occurrence of $\lplus$ just commuted, this we obtain a proof of the following form, equivalent to $\pi$:
\begin{prooftree}
\startproof{$\pi_1$}
\noLine
\UnaryInfC{$!\Gamma \vdash A$}
\RightLabel{$\prom$}
\UnaryInfC{$!\Gamma \vdash !A$}
\startproof{$\pi_2'$}
\noLine
\UnaryInfC{$\Theta, !A, \Theta', D, \Theta'' \vdash B$}
\startproof{$\pi_2''$}
\noLine
\UnaryInfC{$\Theta, !A, \Theta', E, \Theta'' \vdash B$}
\RightLabel{$\lplus$}
\BinaryInfC{$\Theta, !A, \Theta', D \oplus E, \Theta'' \vdash B$}
\RightLabel{$\cut$}
\BinaryInfC{$!\Gamma, \Delta, \Delta' \vdash B$}
\end{prooftree}
where $\Theta, !A, \Theta', D \oplus E, \Theta'' = \Delta, !A, \Delta'$. The result then follows by \eqref{cut:irrelevant_lplus} and two applications of the inductive hypothesis.

Now say there does exist an occurrence of $\rwith$ inside $\pi$ of height $\leq h$. Since $A$ can be written as $A_1, A_2$, and there exists an occurrence of $\rwith$ somewhere inside $\pi$, there is a lowest height $\rwith$ rule inside $\pi_2$ for which there are no right rules of lower height, nor any $\lplus$ rule. Using \eqref{with:unary}, \eqref{with:binary} we can thus commute this rule down to obtain a proof of the following form, equivalent to $\pi$:
\begin{prooftree}
\startproof{$\pi_1$}
\noLine
\UnaryInfC{$!\Gamma \vdash A$}
\RightLabel{$\prom$}
\UnaryInfC{$!\Gamma \vdash !A$}
\startproof{$\pi_2'$}
\noLine
\UnaryInfC{$\Delta, !A, \Delta' \vdash B_1$}
\startproof{$\pi_2''$}
\noLine
\UnaryInfC{$\Delta, !A, \Delta' \vdash B_2$}
\RightLabel{$\rwith$}
\BinaryInfC{$\Delta, !A, \Delta' \vdash B_1 \& B_2$}
\RightLabel{$\cut$}
\BinaryInfC{$!\Gamma, \Delta, \Delta' \vdash B$}
\end{prooftree}
The result then follows from \eqref{cut:any_rwith} and two applications of the inductive hypothesis.
\end{proof}
Theorem \ref{Thm:cut_reduction} was proved by induction, but there is an algorithm implied by the proof which we now write down:
\begin{algorithm}
On input $\pi$:
\begin{enumerate}
    \item\label{step:pick_a_cut} Pick a topmost occurrence of $\cut$, if no such $\cut$ exists then terminate the algorithm. Label the subproof consisting of this $\cut$ rule and the its left and right branches by $\pi$.
    \item Label the left branch of this $\cut$ by $\pi_1, \pi_2$ respectively.
    \item If $\pi_2$ has a conclusion in its final sequent a formula of the form $A_1 \& A_2$ then perform the subprocess of pulling down all the $\lplus$ rules, then all the $\rwith$ rules, followed again by any $\lplus$ rules which do not commute beneath the $\rwith$ rules, then another $\rwith$ rule, and so on, until no more $\lplus$ nor $\rwith$ rules may be brought down. Label the result $\pi_2$.
    \item Bring down all active contractions in $\pi_2$.
    \item Use the cut-reduction steps \ref{cut:irrelevant_lplus}, \ref{cut:any_rwith}, \ref{cut:prom_vs_ctr} several times introducing several new cuts, label the result $\pi_2$.
    \item Pick a topmost cut of $\pi_2$, label the left branch $\pi_2^1$ and the right branch $\pi_2^2$.
    \item\label{step:right_logical} Bring down rules in $\pi_2^1$ using cut-reduction steps until the final rule in the left branch of the cut is a right logical rule.
    \item Bring down rules in $\pi_2^2$ down until either one of the rules proceeding the remark in Definition \ref{def:cut_reduction} about the heart of the cut-reduction rules may be used.
    \item Use this rule then return to step \eqref{step:right_logical}, eventually this cut will be eliminated.
    \item Label the result $\pi$, return to step \eqref{step:pick_a_cut}.
\end{enumerate}
\end{algorithm}
\bibliographystyle{amsalpha}
\providecommand{\bysame}{\leavevmode\hbox to3em{\hrulefill}\thinspace}
\providecommand{\href}[2]{#2}
\begin{thebibliography}{99}
\bibitem{blind} J.Y. Girard, \emph{the Blind spot}, ISBN print 978-3-03719-088-3, 2011.

\bibitem{GoI1} J.Y. Girard, \emph{Geometry of Interaction I, Interpretation of System F}, In Ferro, Bonotto, Valentini, and Zanardo, editors, Logic Colloquium 88, pages 221  260, Amsterdam, 1989. North-Holland.

\bibitem{GoI2} J.Y. Girard, \emph{Geometry of Interaction II, Deadlock Free Algorithms}, In: Martin-Lf P., Mints G. (eds) COLOG-88. COLOG 1988. Lecture Notes in Computer Science, vol 417. Springer, Berlin, Heidelberg. \url{https://doi.org/10.1007/3-540-52335-9_49}

\bibitem{GoI3} J.Y. Girard, \emph{Geometry of Interaction III, Accommodating the Additives}, In Girard, Lafont, and Regnier, editors, Advances in Linear Logic, pages 329  389, Cambridge, 1995. Cambridge University Press.

\bibitem{GoI4} J.Y. Girard, \emph{Geometry of Interaction IV, the Feedback Equation}, In Stoltenberg-Hansen and Vnnen, editors, Logic Colloquium 03, pages 76  117. Association for Symbolic Logic, 2006.

\bibitem{GoI5} J.Y. Girard, \emph{Geometry of Interaction V, Logic in the Hyperfinite Factor}, in memoriam Claire Delaleu (1991-2009). Fully revised version (October 2009).

\bibitem{cofree_cocommutative_coalgebra}, \emph{On Sweedlers Cofree, Cocommutative, Comalgebra}.

\bibitem{linear_logic} J.Y. Girard, \emph{Linear Logic}, Elsevier science publishers V.B. (North-Holland) 1987.

\bibitem{GMZ} D. Murfet, W. Troiani, \emph{The Gentzen-Mints-Zucker Duality}.

\bibitem{gentzen}
G.~Gentzen, \textsl{Untersuchungen \"uber das logische Schliessen}, Mathematische Zeitschrift \textbf{39} (1935) 176--210, 405--431, translation in \textsl{The collected papers of Gerhard Gentzen}, edited by M.~E.~Szabo, 1969.

\end{thebibliography}
\end{document}
